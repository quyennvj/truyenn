"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[6791],{40390:(e,t,i)=>{i.r(t),i.d(t,{default:()=>pn});var o=i(74512),n=i(113),r=i(43644),a=i(24246),s=i(32735),l=i(22538),d=i(54332),c=i(53551),u=i(62904),v=i(80215),p=i(65768),h=i(65597),m=i(53337),g=i(1814),x=i(90938),b=i(17941),f=i(86987),w=i(40809),j=i(651),_=i(61924),y=i(95616),C=i(95407),k=i(84957),S=i(32441),I=i(76628),T=i(32321),M=i(31191),B=i(21296),L=i(3585);let D=class{handleVideoCoverShowReport(e){L.WB.event("video_cover_show",Object.assign(Object.assign({},e),{enter_method:"video_detail",type:"video_detail"}))}handleVideoCoverClickReport(e){L.WB.event("video_cover_click",Object.assign(Object.assign({},e),{enter_method:"video_detail",type:"video_detail"}))}handleBackFypReport(e){L.WB.event("back_fyp_click",Object.assign(Object.assign({},e),{enter_method:"back_fyp_click"}))}handleEnterBrowserModeReport(e){L.WB.event("browse_mode_entry_click",Object.assign(Object.assign({},e),{enter_method:"video_detail_expand_click"}))}handleKebabMenuHoverReport(e){L.WB.event("kebab_menu_hover",e)}handleRelatedVideoImprCntReport(e){L.WB.event("related_video_impr_cnt",e)}};D=(0,M.__decorate)([(0,B.G)()],D);var O=i(52970),E=i(54032),P=i(90883),Z=i(52687),R=i(54348),z=i(17609),F=i(9086),V=i.n(F),$=i(35002),q=i(14584),H=i(44435),W=i(86303),N=i(28698),A=i(73323),U=i(49449),G=i(82394),Y=i(85969),J=i(57852),Q=i(74751),K=i(6229),X=i(16219),ee=i(11359),te=i(31144),ie=i(71011),oe=i(51166),ne=i(30526),re=i(52702),ae=i(37674),se=i(55251),le=i(86319),de=i(2355),ce=i(14656),ue=i(90674),ve=i(88916),pe=i(47159),he=i(61080),me=i(81104);const ge=/([0-9]{1,2})?:?([0-9]{2}):([0-9]{2}\.[0-9]{2,3})/;function xe(e){return ge.test(e)}function be(e){const t=e.match(ge);let i=60*parseFloat(t[1]||"0")*60;return i+=60*parseFloat(t[2]),i+=parseFloat(t[3]),Number(i.toFixed(6))}const fe=e=>{var t;const i={"cmn-Hans-CN":"zh-CN","eng-US":"en-US","jpn-JP":"jp-JP","kor-KR":"ko-KR","cmn-Hans-CN|eng-US":"en-US","rus-RU":"ru-RU","fra-FR":"fr-FR","por-PT":"pt-PT","spa-ES":"es-ES","afr-ZA":"en-ZA","ben-BD":"bn-BD","ces-CZ":"cs-CZ","dan-DK":"da-DK","nld-NL":"nl-NL","fin-FI":"fi-FI","deu-DE":"de-DE","ell-GR":"el-GR","hun-HU":"hu-HU","ind-ID":"id-ID","gle-IE":"en-IE","ita-IT":"it-IT","nor-NO":"no-NO","pol-PL":"pl-PL","swe-SE":"sv-SE","tha-TH":"th-TH","tur-TR":"tr-TR","ara-SA":"ar-SA","fra-CA":"fr-CA","cmn-Hant-CN":"zh-TW","heb-IL":"he-IL","jva-ID":"id-ID","ron-RO":"ro-RO","hin-IN":"hi-IN","ben-IN":"bn-BD","slk-SK":"sk-SK"};return null!==(t=null==i?void 0:i[e])&&void 0!==t?t:"en-US"};var we=i(79006),je=i(70336);let _e=class{constructor(e){this.fetch=e}downloadTranscript(e){return this.fetch.get(e)}};_e=(0,M.__decorate)([(0,B.G)(),(0,M.__metadata)("design:paramtypes",[je.r])],_e);let ye=class extends K.D{constructor(e,t,i,o,n,r){super(),this.service=e,this.itemList=t,this.videoPlayer=i,this.videoExperience=o,this.itemModule=n,this.appContext=r,this.defaultState={currentIndex:0,itemListKey:"video",subtitleContent:[],ifShowSubtitle:!1,subtitleStruct:null}}setCurrentIndex(e,t){e.currentIndex=t}setSubtitleContent(e,t){e.subtitleContent=t}setIfShowSubtitle(e,t){e.ifShowSubtitle=t}setSubtitleStruct(e,t){const i=this.getOriginalSubtitleStruct(t);i&&(e.subtitleStruct=i)}handleSelectVideo(e){return e.pipe((0,ne.b)((()=>{this.videoExperience.reportVideoInteractStart({startTime:Date.now(),situation:"video_detail_select"})})),(0,te.M)(this.state$,this.itemList.state$,this.itemModule.state$,this.appContext.state$),(0,ie.U)((([{newIndex:e},{itemListKey:t,currentIndex:i},o,n,r])=>{var a,s,l;const d=null!==(s=null===(a=o[null!=t?t:""])||void 0===a?void 0:a.browserList)&&void 0!==s?s:[];return{newIndex:e,isIndexInvalid:!(null==d?void 0:d.length)||e<0||e===i,newId:null!==(l=d[e])&&void 0!==l?l:"",enterMethod:"video_cover_click",itemModuleState:n,appContextState:r}})),(0,ne.b)((({isIndexInvalid:e})=>{e&&console.warn("cannot switch to next video for some reasons")})),(0,re.z)((e=>{var{itemModuleState:t,appContextState:i}=e,o=(0,M.__rest)(e,["itemModuleState","appContextState"]);const n=[...this.updateVideoIndex(o)];return o.isIndexInvalid||n.push(this.getActions().setSubtitleContent([])),(0,ae.of)(...n)})),(0,me.n)({}))}handleFirstVideo(e){return e.pipe((0,te.M)(this.state$,this.itemList.state$),(0,ie.U)((([e,{itemListKey:t},i])=>{var o,n,r;const a=null!==(n=null===(o=i[null!=t?t:""])||void 0===o?void 0:o.browserList)&&void 0!==n?n:[];return{newIndex:0,isIndexInvalid:!(null==a?void 0:a.length)||0>a.length-1,newId:null!==(r=a[0])&&void 0!==r?r:"",enterMethod:"video_detail"}})),(0,ne.b)((({isIndexInvalid:e})=>{e&&console.warn("cannot switch to first video for some reasons")})),(0,re.z)((e=>(0,ae.of)(...this.updateVideoIndex(e)))),(0,me.n)({}))}downloadTranscript(e){return e.pipe((0,re.z)((e=>this.downloadTranscript$(e).pipe((0,le.l)(this.terminate())))))}downloadTranscript$(e){if(!e)return(0,ae.of)().pipe();const t=this.getOriginalSubtitleStruct(e.subtitleInfos);return t?(0,ae.of)(e).pipe((0,re.z)((()=>this.service.downloadTranscript(t.url).pipe((0,he.K)((()=>(0,ae.of)())),(0,re.z)((e=>{const t=((e,t)=>{if(!e)return{cues:[]};t||(t={});const{meta:i=!1,strict:o=!0}=t,n=(e=(e=(e=e.trim()).replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).split("\n\n"),r=n.shift();if(!(null==r?void 0:r.startsWith("WEBVTT")))throw new Error('Must start with "WEBVTT"');const a=r.split("\n"),s=a[0].replace("WEBVTT","");if(s.length>0&&" "!==s[0]&&"\t"!==s[0])throw new Error("Header comment must start with space or tab");if(0===n.length&&1===a.length)return{valid:!0,strict:o,cues:[],errors:[]};if(!i&&a.length>1&&""!==a[1])throw new Error("Missing blank line after signature");const{cues:l,errors:d}=function(e,t){const i=[];return{cues:e.map(((e,o)=>{try{return function(e,t,i){let o=0,n=.01,r="";const a=e.split("\n").filter(Boolean);if(a.length>0&&a[0].trim().startsWith("NOTE"))return null;if(1===a.length&&!a[0].includes("--\x3e"))throw new Error(`Cue identifier cannot be standalone (cue #${t})`);if(a.length>1&&!a[0].includes("--\x3e")&&!a[1].includes("--\x3e"))throw new Error(`Cue identifier needs to be followed by timestamp (cue #${t})`);const s=a[0].split(" --\x3e ");if(2!==s.length||!xe(s[0])||!xe(s[1]))throw new Error(`Invalid cue timestamp (cue #${t})`);const l=function(e){const t=e.split(".")[0],i=t.split(":");return"00"!==i[0]?t:i[1]+":"+i[2]}(s[0]);if(o=be(s[0]),n=be(s[1]),i){if(o>n)throw new Error(`Start timestamp greater than end (cue #${t})`);if(n<=o)throw new Error(`End must be greater than start (cue #${t})`)}if(!i&&n<o)throw new Error(`End must be greater or equal to start when not strict (cue #${t})`);return a.shift(),r=a.join("\n"),!!r&&{start:o,end:n,text:r,startStr:l}}(e,o,t)}catch(e){return i.push(e),null}})).filter(Boolean),errors:i}}(n,o);if(o&&d.length>0)throw d[0];const c=i?function(e){const t={};return e.slice(1).forEach((e=>{const i=e.indexOf(":"),o=e.slice(0,i).trim(),n=e.slice(i+1).trim();t[o]=n})),Object.keys(t).length>0?t:null}(a):null,u={valid:0===d.length,strict:o,cues:l,errors:d,meta:{}};return i&&c&&(u.meta=c),u})(e);return(0,ae.of)(this.getActions().setSubtitleContent(t.cues),this.terminate())})))))):(0,ae.of)().pipe()}updateVideoIndex({newIndex:e,isIndexInvalid:t,newId:i,enterMethod:o}){return t?[this.noop()]:[this.videoPlayer.getActions().updateVideo({currentVideo:{index:e,id:i,mode:4},playProgress:0,teaParams:{isVideoDetail:!0,enterMethod:o}}),this.getActions().setCurrentIndex(e)]}getOriginalSubtitleStruct(e){const t=null==e?void 0:e.find((e=>"1"===e.Version||"3"===e.Version));return(null==t?void 0:t.Url)&&(null==t?void 0:t.LanguageCodeName)?{url:t.Url,language:fe(t.LanguageCodeName)}:null}};(0,M.__decorate)([(0,X.lF)(),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[Object,Number]),(0,M.__metadata)("design:returntype",void 0)],ye.prototype,"setCurrentIndex",null),(0,M.__decorate)([(0,X.lF)(),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[Object,Array]),(0,M.__metadata)("design:returntype",void 0)],ye.prototype,"setSubtitleContent",null),(0,M.__decorate)([(0,X.lF)(),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[Object,Boolean]),(0,M.__metadata)("design:returntype",void 0)],ye.prototype,"setIfShowSubtitle",null),(0,M.__decorate)([(0,X.lF)(),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[Object,Object]),(0,M.__metadata)("design:returntype",void 0)],ye.prototype,"setSubtitleStruct",null),(0,M.__decorate)([(0,X.Qm)(),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[de.y]),(0,M.__metadata)("design:returntype",void 0)],ye.prototype,"handleSelectVideo",null),(0,M.__decorate)([(0,X.Qm)(),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[de.y]),(0,M.__metadata)("design:returntype",void 0)],ye.prototype,"handleFirstVideo",null),(0,M.__decorate)([(0,X.Qm)(),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[de.y]),(0,M.__metadata)("design:returntype",void 0)],ye.prototype,"downloadTranscript",null),ye=(0,M.__decorate)([(0,ee.Y)("VideoDetailModule"),(0,M.__metadata)("design:paramtypes",[_e,u.h,A.f,we.KF,E.A,ve.G])],ye);let Ce=class{constructor(e){this.fetch=e}getVideoDetail(e){return this.fetch.get("/api/item/detail/",{query:e,baseUrlType:3})}};Ce=(0,M.__decorate)([(0,B.G)(),(0,M.__metadata)("design:paramtypes",[je.r])],Ce);let ke=class{redirect(e){}};ke=(0,M.__decorate)([(0,B.G)()],ke);let Se=class extends K.D{constructor(e,t,i,o,n,r){super(),this.service=e,this.redirectService=t,this.appContext=i,this.itemList=o,this.seoModule=n,this.videoDetail=r,this.defaultState={statusCode:0}}setStatusCode(e,t){e.statusCode=t}getVideoDetail(e){return e.pipe((0,te.M)(this.appContext.state$),(0,ie.U)((([{itemId:e,query:t},i])=>{var o,n;const{appContext:r}=i,a=null!==(o=(0,ce.x)(null==r?void 0:r.$abTestVersion,"add_transcript"))&&void 0!==o?o:"v1",s=["v2","v3","v4"].includes(a);return{itemId:e,lang:i.lang,query:t,$isGoogleBot:null===(n=i.appContext)||void 0===n?void 0:n.$isGoogleBot,needDownloadTranscript:s}})),(0,oe.z)((({itemId:e="",lang:t,query:i="",$isGoogleBot:o,needDownloadTranscript:n})=>this.service.getVideoDetail({aid:ue.CO,itemId:e}).pipe((0,ne.b)((e=>{this.redirectService.redirect(e)})),(0,re.z)((e=>{var r,a;const{statusCode:s,itemInfo:l}=e,d=null==l?void 0:l.itemStruct,c=[(0,ae.of)(this.getActions().setStatusCode(s)),(0,ae.of)(this.itemList.getActions().setList({key:"video",response:{statusCode:s,itemList:d?[d]:[],hasMore:!0}})),this.seoModule.setVideoSEOProps(e,{$language:t},i)];return 0===s&&(n&&c.push((0,ae.of)(this.videoDetail.getActions().setSubtitleStruct(null===(a=null===(r=null==l?void 0:l.itemStruct)||void 0===r?void 0:r.video)||void 0===a?void 0:a.subtitleInfos))),o&&c.push(this.itemList.getRecommendList$({key:"video"}))),(0,se.T)(...c)})),(0,le.l)(this.itemList.getActions().setListKeyword({key:"video",keyword:e}),this.terminate())))))}};function Ie(){const[{loading:e,hasMore:t},i]=(0,a.b7)(u.h,{selector:e=>{var t,i,o,n;return{loading:null!==(i=null===(t=null==e?void 0:e.video)||void 0===t?void 0:t.loading)&&void 0!==i&&i,hasMore:null===(n=null===(o=null==e?void 0:e.video)||void 0===o?void 0:o.hasMore)||void 0===n||n}},dependencies:[]});return(0,s.useCallback)((()=>{!e&&t&&i.getRecommendList({key:"video"})}),[i,t,e])}(0,M.__decorate)([(0,X.lF)(),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[Object,Number]),(0,M.__metadata)("design:returntype",void 0)],Se.prototype,"setStatusCode",null),(0,M.__decorate)([(0,X.Qm)({payloadGetter:1}),(0,M.__metadata)("design:type",Function),(0,M.__metadata)("design:paramtypes",[de.y]),(0,M.__metadata)("design:returntype",void 0)],Se.prototype,"getVideoDetail",null),Se=(0,M.__decorate)([(0,ee.Y)("VideoPage"),(0,M.__metadata)("design:paramtypes",[Ce,ke,ve.G,u.h,pe.q,ye])],Se);const Te=()=>{var e;const{list:t,loading:i}=(0,a.mp)(u.h,{selector:e=>{var t;return null!==(t=e.video)&&void 0!==t?t:{list:[],loading:!0,statusCode:0}},dependencies:[]}),o=(0,a.mp)(Se,{selector:({statusCode:e})=>e,dependencies:[]}),{$user:n}=null!==(e=(0,f.L)((()=>["$user"]),[]))&&void 0!==e?e:{},r=(0,a.mp)(A.f,{selector:e=>{var t;return Number(null===(t=e.currentVideo)||void 0===t?void 0:t.index)},dependencies:[]}),s=t[r],l=(0,a.mp)(E.A,{selector:e=>e[null!=s?s:""],dependencies:[s]}),{showNotPass:d,takeDown:c,shareEnabled:v}=null!=l?l:{},{ftcUser:p}=null!=n?n:{},h=p&&!v,m=10101===o,g=!m&&(0!==o&&10404!==o&&10231!==o&&!(0,U.m)(o)||10231===o&&!l||d||6===c||h);return{isServerError:m,isCommonError:g,isInitLoading:i&&!(null==t?void 0:t.length)&&!g,isEmpty:!(m||g||i||t.length)}},Me=()=>{const{id:e}=(0,l.UO)(),t=(0,a.qj)(u.h),i=(0,a.qj)(Se);return(0,s.useCallback)((()=>{t.resetItemList({key:"video"}),i.getVideoDetail({itemId:e})}),[t,e,i])};var Be=i(40200),Le=i(29984);const De=(0,Be.Z)("div",{target:"eueotzt0"})((({theme:{direction:e},showVideoCommentDetail:t=!1})=>[(0,Le.YJ)({direction:e,marginEnd:24,marginStart:t?24:0}),{width:t?"unset":"692px",maxWidth:t?"unset":"692px",padding:"24px 0",flex:t?"1 1 auto":""},(0,Le.f1)({max:767,style:(0,Le.YJ)({direction:e,marginStart:16})})]),"label:DivMainContainer;"),Oe=(0,Be.Z)("div",{target:"eueotzt1"})({padding:"210px 0"},"label:DivErrorWrapper;"),Ee=(0,Be.Z)("h2",{target:"eueotzt2"})((({theme:e})=>[(0,Le.GI)({theme:e,fontFamily:"Sofia",fontWeight:"bold",typography:"H3"}),(0,Le.YJ)({direction:e.direction,marginStart:"-68px"}),{marginTop:"30px",color:e.colors.TextPrimary}]),"label:H2RecommendTitle;");var Pe=i(15490),Ze=i(24658),Re=i(59493),ze=i(84774),Fe=i(37039),Ve=i(24448),$e=i(76427),qe=i(99583),He=i(99350),We=i(60083),Ne=i(99971),Ae=i(34525),Ue=i(69847),Ge=i(39917),Ye=i(66502),Je=i(84385),Qe=i(34011),Ke=i(48689),Xe=i(48504);const et=(0,Be.Z)("div",{target:"ev7d2j50"})({display:"flex",flexDirection:"row",alignItems:"center",position:"relative",flex:"0 0 82px",width:"320px"},"label:DivInfoContainer;"),tt=(0,Be.Z)("span",{target:"ev7d2j51"})((({theme:e})=>(0,Le.GI)({theme:e,typography:"P1",fontWeight:"bold",fontFamily:"Sofia"})),"label:SpanUniqueId;");tt.defaultProps=Object.assign(Object.assign({},tt.defaultProps),{"data-e2e":"browse-username"});const it=(0,Be.Z)("span",{target:"ev7d2j52"})((({theme:e})=>(0,Le.GI)({theme:e,typography:"P3",fontFamily:"Proxima"})),{display:"flex",alignItems:"center","> span":Le.wj},"label:SpanOtherInfos;");it.defaultProps=Object.assign(Object.assign({},it.defaultProps),{"data-e2e":"browser-nickname"});const ot=(0,Be.Z)(Qe.D,{target:"ev7d2j53"})(Le.wj,Le.gi,{flex:"1 1 auto",":hover":{[`${tt}`]:{textDecoration:"underline"}}},(({theme:{direction:e}})=>(0,Le.YJ)({direction:e,marginEnd:"12px"})),"label:StyledLink;"),nt=({theme:{direction:e}})=>[{flex:"0 0 40px",":hover":{[`~ ${ot} ${tt}`]:{textDecoration:"underline"}}},(0,Le.YJ)({direction:e,marginEnd:"12px"})],rt=(0,Be.Z)(Xe.W,{target:"ev7d2j56"})({justifySelf:"flex-end","& > svg":{marginRight:"6px"}},"label:StyledFollowButton;");rt.defaultProps=Object.assign(Object.assign({},rt.defaultProps),{"data-e2e":"browse-follow"});const at=(0,s.memo)((function(e){const{uniqueId:t,videoId:i,teaParams:n}=e,r=(0,a.mp)(Ve.z,{selector:e=>e.users[t],dependencies:[t]}),{t:l,timeTranslator:d}=(0,$e.e)(),c=(0,a.mp)(E.A,{selector:e=>null==e?void 0:e[i],dependencies:[i]}),{secret:u,forFriend:v,createTime:p}=null!=c?c:{},{showing:h,handleCardEnter:m,handleCardLeave:g,handleItemEnter:x,handleItemLeave:b}=(0,qe.V)(),f=(0,He.zW)(r),{isShowLive:w}=f;(0,He.TB)({isShowLive:w,reportTrigger:w,user:r,enterMethod:w?"video_head_browser":"creator",autoReport:!0,reportValidator:()=>void 0!==(null==r?void 0:r.relation),once:!0});const j=(0,He.CN)(Object.assign({user:r,enterMethod:w?"video_head_browser":"creator"},n)),_=(0,s.useMemo)((()=>Object.assign(Object.assign({},j),{author_id:j.to_user_id,group_id:i})),[j,i]),y=(0,s.useMemo)((()=>{if(r)return Object.assign(Object.assign({},j),{author_id:r.id,to_user_id:r.id,group_id:i,enterMethod:"creator"})}),[r,i,j]);if(!r)return(0,We.G)(["authorInfo"]);const{nickname:C,secUid:k,verified:S}=r,I=function(e){return e?(0,Be.Z)(Ke.G,{target:"ev7d2j54"})(nt):(0,Be.Z)(Qe.D,{target:"ev7d2j55"})(nt)}(w);return(0,o.jsxs)(et,{children:[(0,o.jsx)(I,Object.assign({uniqueId:t,secUid:k,onMouseEnter:x,onMouseLeave:b,isInBrowserMode:!0,teaParams:_,"data-e2e":"browse-user-avatar",onClick:e.onClick,onLinkClick:e.onLinkClick},{children:(0,o.jsx)(Ne.k,Object.assign({needAnimation:!0,liveTheme:2,size:40},f),void 0)}),void 0),(0,o.jsxs)(ot,Object.assign({uniqueId:t,secUid:k,onMouseEnter:x,onMouseLeave:b,isInBrowserMode:!0,teaParams:y,onClick:e.onClick,onLinkClick:e.onLinkClick},{children:[(0,o.jsxs)(tt,{children:[t,S&&(0,o.jsx)(Ge.Q,{width:14,height:14,"data-e2e":"browse-bluev"},void 0)]},void 0),(0,o.jsx)("br",{},void 0),(0,o.jsxs)(it,{children:[C,(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",Object.assign({style:{margin:"0 4px"}},{children:" · "}),void 0),(0,o.jsx)("span",{children:d(1e3*Number(p))},void 0)]},void 0),u&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",Object.assign({style:{margin:"0 4px"}},{children:" · "}),void 0),(0,o.jsx)(Re.Z,{width:16,height:16,style:{fill:"#121212",opacity:.5,margin:"0 4px"}},void 0),(0,o.jsx)("span",{children:l("video_label_private")},void 0)]},void 0),v&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:" · "},void 0),(0,o.jsx)(ze.Z,{style:{margin:"0 4px"},width:20,height:20},void 0),(0,o.jsx)("span",Object.assign({className:"friend"},{children:l("Friends only")}),void 0)]},void 0)]},void 0)]}),void 0),(0,o.jsx)(st,{author:r,video:c,videoReportParams:n},void 0),h&&(0,o.jsx)(Ae.C,{top:30,fixedLeft:32,onMouseEnter:m,onMouseLeave:g,uniqueId:t},void 0)]},void 0)})),st=function({author:e,video:t,videoReportParams:i}){var n;const r=(0,a.mp)(ve.G,{selector:t=>{var i,o;return(null===(o=null===(i=t.appContext)||void 0===i?void 0:i.$user)||void 0===o?void 0:o.uniqueId)===e.uniqueId},dependencies:[e.uniqueId]}),s=(0,Ue.Q)({query:{enter_method:"click_follow"}}),{text:l,handleFollow:d,isFollowing:c,relation:u}=(0,q.w)({uniqueId:e.uniqueId,onNeedLogin:s,teaParams:Object.assign({group_id:null==t?void 0:t.id},i)});return(null==t?void 0:t.scheduleTime)?(0,o.jsx)(Ye.Q,{video:t},void 0):r?(0,o.jsx)(Je.C,{videoId:null!==(n=null==t?void 0:t.id)&&void 0!==n?n:""},void 0):(0,o.jsxs)(rt,Object.assign({size:"small",buttonTheme:c?"default":"primary",onClick:d},{children:[2===u?(0,o.jsx)(Fe.Z,{},void 0):null,l]}),void 0)};var lt=i(87310),dt=i(18654),ct=i(12779),ut=i(42669);const vt=(0,s.memo)((({isCommentDisabled:e,authorId:t,itemId:i,teaParams:n})=>{var r,a;const{$user:l}=null!==(r=(0,f.L)((()=>["$user"]),[]))&&void 0!==r?r:{},d=Boolean(l),c=(0,x.Q)(),{nickname:u=""}=null!==(a=(0,q.p)(t))&&void 0!==a?a:{},{isBrowserModeShowing:v}=(0,s.useContext)(z._),p=(0,Ue.Q)(),h=(0,s.useMemo)((()=>v?null:(0,o.jsx)(ct._,{itemId:i,teaParams:n},void 0)),[v,i,n]);return(0,o.jsxs)(ut.zQ,{children:[d?(0,o.jsx)(dt.q,{size:40,src:null==l?void 0:l.avatarUri[0]},void 0):(0,o.jsx)(ut.CO,{},void 0),d?e?(0,o.jsx)(ut.th,{children:c("comment_disable_notfollow").replace("%@",u)},void 0):(0,o.jsx)(ut.SC,{children:h},void 0):(0,o.jsx)(ut.lb,Object.assign({onClick:p},{children:(0,o.jsx)(ut.Vk,{children:c("video_details_page_comment_field_cta")},void 0)}),void 0)]},void 0)})),pt=(0,s.memo)((0,s.forwardRef)((function(e,t){var i,n;const{itemId:r="",teaParams:l,scheduleTime:d=""}=e,c=(0,x.Q)(),{$user:u}=null!==(i=(0,f.L)((()=>["$user"]),[]))&&void 0!==i?i:{},[v]=(0,a.b7)(E.A,{selector:e=>e[null!=r?r:""],dependencies:[r]}),{loading:p,comments:h}=(0,a.mp)(Ze.x),m=(0,q.p)(null==v?void 0:v.author),g=(0,s.useMemo)((()=>3===(null==v?void 0:v.itemCommentStatus)||3===(null==m?void 0:m.commentSetting)),[null==m?void 0:m.commentSetting,null==v?void 0:v.itemCommentStatus]),w=(0,s.useMemo)((()=>(0,b.sA)(m,null==u?void 0:u.uid)),[m,null==u?void 0:u.uid]),{stats:j}=null!=v?v:{},_=p&&!h.length,y=null!==(n=null==j?void 0:j.commentCount)&&void 0!==n?n:0,C=c("video_details_page_comment_header",{num:y<=1?1:y,Count:(0,b.BT)(y)});return d?(0,o.jsx)(ut.SX,{children:(0,o.jsx)(ut.Is,{children:c("scheduled_video_comment_unavailable")},void 0)},void 0):(0,o.jsxs)(ut.SX,Object.assign({ref:t},{children:[_?null:(0,o.jsx)(ut._u,{children:C},void 0),_?null:(0,o.jsx)(vt,{teaParams:l,itemId:r,authorId:null==v?void 0:v.author,isCommentDisabled:w},void 0),g?(0,o.jsx)(ut.Is,Object.assign({"data-e2e":"comment-turned-off"},{children:c("comment_off")}),void 0):(0,o.jsx)(lt.$,{inDetailPage:!0,itemId:r,disableReply:w,teaParams:l},void 0)]}),void 0)})));var ht=i(14400),mt=i(59719),gt=i(85795),xt=i(66164),bt=i(36668);function ft({relatedList:e,isNarrowState:t,onLoadMore:i,hasMore:o,isLoading:n}){const[r,a]=(0,s.useState)(1),[l,d]=(0,s.useState)(!0);return(0,s.useEffect)((()=>{t&&(a(1),d(!0))}),[t]),(0,s.useEffect)((()=>{t&&d(n||e.length>16*r)}),[e.length,t,r,n]),{narrowStateHasMore:l,handleLoadMore:(0,s.useCallback)((()=>{e.length-16*(r+1)<0&&o&&i(),a(r+1)}),[i,e,r,o]),narrowStateList:(0,s.useMemo)((()=>e.slice(0,16*r)),[e,r])}}var wt=i(12502);const jt=(0,Be.Z)("div",{target:"elgg5o60"})({},"label:DivVideoDetailContainer;"),_t=(0,Be.Z)("div",{target:"elgg5o61"})({height:0,width:"1px",position:"absolute",marginTop:"-84px"},"label:DivEmptyWrapper;"),yt=(0,Be.Z)("div",{target:"elgg5o62"})({height:"48px",fontSize:"24px",color:"#000000",display:"flex",marginBottom:"16px"},"label:DivBackHead;"),Ct=(0,Be.Z)("div",{target:"elgg5o63"})({fontSize:"24px",color:"#000000",display:"flex",cursor:"pointer",alignItems:"center"},"label:DivHeadContent;"),kt=(0,Be.Z)(wt.Z,{target:"elgg5o64"})((({theme:e})=>[(0,Le.YJ)({direction:e.direction,marginStart:"14px"}),{transform:"rtl"===e.direction?"rotate(180deg)":""}]),"label:StyledChevronLeftOffset;"),St=(0,Be.Z)("span",{target:"elgg5o65"})((({theme:e})=>[(0,Le.YJ)({direction:e.direction,marginStart:"4px"}),{lineHeight:"48px",fontSize:"16px",color:"#000000"}]),"label:SpanBackTitle;"),It=(0,Be.Z)("div",{target:"elgg5o66"})({display:"flex"},"label:DivContentContainer;"),Tt=(0,Be.Z)("div",{target:"elgg5o67"})((({theme:e})=>[(0,Le.YJ)({direction:e.direction,marginEnd:"24px"}),{flex:"1 1 808px"}]),"label:DivLeftContainer;"),Mt=(0,Be.Z)("div",{target:"elgg5o68"})({padding:"16px 0",borderBottom:"1px solid #F1F1F1"},"label:DivAuthorContainer;"),Bt=(0,Be.Z)("div",{target:"elgg5o69"})({width:"322px",flex:"0 0 322px"},"label:DivVideoList;"),Lt=(0,Be.Z)("p",{target:"elgg5o610"})((({theme:e})=>(0,Le.GI)({theme:e,fontWeight:"semiBold"})),Le.wj,{color:"#161823",fontSize:"18px",marginBottom:"15px",lineHeight:"24px"},"label:PVideoListTitle;"),Dt=(0,Be.Z)("div",{target:"elgg5o611"})({width:"100%",height:"606px",background:"rgba(18, 18, 18, 0.03)",position:"relative",overflow:"hidden",borderRadius:"4px",marginBottom:"24px"},"label:DivVideoContentSkeleton;");var Ot=i(89808),Et=i(99381),Pt=i.n(Et);let Zt=class{constructor(){this.handleClickTranscriptLine=e=>{L.WB.event("click_transcript_line",{time_clicked:e})},this.handleCloseTranscriptPanel=(e,t)=>{L.WB.event("close_transcript_panel",{enter_method:e,is_pinned:t})},this.handleShowTranscriptPanel=(e,t)=>{L.WB.event("show_transcript_panel",{enter_method:e,is_pinned:t})}}};Zt=(0,M.__decorate)([(0,B.G)()],Zt);var Rt,zt,Ft=i(16572);function Vt(){return Vt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Vt.apply(this,arguments)}const $t=function(e){return s.createElement("svg",Vt({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},e),Rt||(Rt=s.createElement("path",{fill:"#161823",fillRule:"evenodd",d:"M3 4a2 2 0 012-2h14a2 2 0 012 2v16a2 2 0 01-2 2H5a2 2 0 01-2-2V4zm16 0H5v16h14V4z",clipRule:"evenodd"})),zt||(zt=s.createElement("path",{fill:"#161823",fillRule:"evenodd",d:"M8 7.5a.5.5 0 01.5-.5h7a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-7a.5.5 0 01-.5-.5v-1zm0 4a.5.5 0 01.5-.5h7a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-7a.5.5 0 01-.5-.5v-1zm.5 3.5a.5.5 0 00-.5.5v1a.5.5 0 00.5.5h4a.5.5 0 00.5-.5v-1a.5.5 0 00-.5-.5h-4z",clipRule:"evenodd"})))};var qt=i(63221),Ht=i(1127);const Wt=(0,Be.Z)("div",{target:"e46f5az0"})((({theme:{direction:e,colors:t}})=>[(0,Le.YJ)({direction:e,paddingStart:16,paddingEnd:8}),{height:40,background:t.BGCreation3,opacity:.88,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"}]),"label:DivTranscriptHeader;"),Nt=(0,Be.Z)("span",{target:"e46f5az1"})((({theme:{direction:e}})=>[(0,Le.YJ)({direction:e,marginStart:8}),{fontWeight:600,fontSize:"16px",flex:1}]),"label:SpanHeadertext;"),At=(0,Be.Z)(Ht.Z,{target:"e46f5az2"})((({reversed:e})=>[{width:"16px",height:"16px",verticalAlign:"middle",transform:e?"rotate(180deg)":"none"}]),"label:StyledChevronDownFill;"),Ut=(0,Be.Z)("ul",{target:"e46f5az3"})((({theme:{colors:e},isShow:t})=>[{fontWeight:400,fontSize:"14px",listStyleType:"none",padding:"0 0 16px 0",marginBottom:24,marginTop:0,background:e.BGPlaceholderOpaque,display:t?"block":"none",maxHeight:432,overflow:"auto",position:"relative"}]),"label:UlTranscriptList;"),Gt=(0,Be.Z)("li",{target:"e46f5az4"})((({theme:{direction:e,colors:t},isCurrent:i,isRTL:o})=>[{minHeight:38,padding:"8px 16px",display:"flex",cursor:"pointer",":hover":{backgroundColor:t.BGCreation3}},i?Object.assign({backgroundColor:t.BGCreation3,borderRight:o?`4px solid ${t.Primary}`:"",borderLeft:o?"":`4px solid ${t.Primary}`},(0,Le.YJ)({direction:e,paddingStart:"12px"})):{}]),"label:LiTranscriptItem;"),Yt=(0,Be.Z)("div",{target:"e46f5az5"})((({theme:{direction:e,colors:t}})=>[(0,Le.YJ)({direction:e,marginEnd:16}),{color:t.ConstBGInverse}]),"label:DivTranscriptTime;"),Jt=(0,Be.Z)("div",{target:"e46f5az6"})((({theme:{colors:e}})=>[{color:e.Primary2,wordWrap:"break-word",wordBreak:"break-word"}]),"label:DivTranscriptText;"),Qt=(0,Be.Z)("div",{target:"e46f5az7"})((({theme:{colors:e}})=>[{height:1,backgroundColor:e.BGPlaceholderOpaque,marginBottom:24}]),"label:DivSplitLine;"),Kt=(0,Be.Z)("div",{target:"e46f5az8"})({cursor:"pointer"},"label:DivCloseIconContainer;"),Xt=(0,s.memo)((function({item:e,onSeek:t,isNarrow:i,isListShow:n,setIsListShow:r}){const{id:l}=e,[{subtitleContent:d},c]=(0,a.b7)(ye),u=(0,T.fz)(Zt),v=(0,s.useRef)(0),h=(0,s.useRef)(!1),m=(0,s.useMemo)((()=>{const e=Pt()(d);return e[0].start>=1&&e.unshift({end:0,start:0,startStr:"00:00",text:""}),e}),[d]),[{currentTime:g}]=(0,a.b7)(qt.M,{selector:e=>e[l]?e[l]:{duration:0,videoPercent:0,currentTime:0},dependencies:[l]}),{isDefaultExpanded:b,isShowCloseIcon:f}=(0,p.II)(),{isRTL:w}=(0,Ft.Y)(),j=(0,s.useRef)(null),_=(0,s.useCallback)((()=>{f||(n?(u.handleCloseTranscriptPanel("expand_panel",b?1:0),r(!1)):(u.handleShowTranscriptPanel("expand_panel",b?1:0),r(!0)))}),[n,f,u,b,r]),y=(0,s.useCallback)((e=>{t(e),u.handleClickTranscriptLine(e)}),[u,t]),C=(0,s.useCallback)((()=>{u.handleCloseTranscriptPanel("click_transcript",0),c.setIfShowSubtitle(!1)}),[c,u]),k=(0,s.useCallback)((e=>{var t,i,o,n,r,a,s,l;if(h.current)return;const d=null===(i=null===(t=null==j?void 0:j.current)||void 0===t?void 0:t.children)||void 0===i?void 0:i[e],c=null==d?void 0:d.offsetTop,u=null===(o=null==j?void 0:j.current)||void 0===o?void 0:o.scrollTop,v=null==d?void 0:d.clientHeight,p=c-u,m=p<432&&p>-v;if(e>2){const t=null===(a=null===(r=null===(n=null==j?void 0:j.current)||void 0===n?void 0:n.children)||void 0===r?void 0:r[e-2])||void 0===a?void 0:a.offsetTop;null===(s=null==j?void 0:j.current)||void 0===s||s.scrollTo({top:t,behavior:"smooth"})}else m||null===(l=null==j?void 0:j.current)||void 0===l||l.scrollTo({top:0,behavior:"smooth"})}),[j,h]),S=(0,s.useCallback)((()=>{h.current=!0}),[h]),I=(0,s.useCallback)((()=>{h.current=!1}),[h]),M=(0,s.useCallback)((()=>{var e;let t=0;for(let i=m.length-1;i>=0;i--)if(m[i].start<=g||g>(null===(e=null==m?void 0:m[i-1])||void 0===e?void 0:e.end)&&Math.abs(m[i].start-g)<.001){t=i,v.current!==i&&(v.current=i,k(i));break}return m.map(((e,i)=>(0,o.jsxs)(Gt,Object.assign({isCurrent:t===i,onClick:()=>y(e.start),isRTL:w},{children:[(0,o.jsx)(Yt,{children:e.startStr},void 0),(0,o.jsx)(Jt,{children:e.text},void 0)]}),i)))}),[m,g,y,w,k]),B=(0,x.Q)();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",Object.assign({style:{marginTop:i?"32px":0}},{children:[(0,o.jsxs)(Wt,Object.assign({onClick:_,style:{cursor:f?"auto":"point"}},{children:[(0,o.jsx)($t,{},void 0),(0,o.jsx)(Nt,{children:B("asr_transcript_onpc_kebab_menu_ab_transcript_button")},void 0),f?(0,o.jsx)(Kt,Object.assign({onClick:C},{children:(0,o.jsx)(Ot.Z,{height:12,width:12},void 0)}),void 0):(0,o.jsx)(At,{reversed:n},void 0)]}),void 0),(0,o.jsx)(Ut,Object.assign({isShow:n,ref:j,onMouseEnter:S,onMouseLeave:I},{children:M()}),void 0)]}),void 0),(0,o.jsx)(Qt,{},void 0)]},void 0)})),ei=(0,Be.Z)("div",{target:"efs4npu0"})({display:"flex",width:"100%",flexWrap:"wrap"},"label:DivVideoCardSkeletonContainer;"),ti=(0,Be.Z)("div",{target:"efs4npu1"})({width:"100%",height:"120px",marginBottom:"16px",background:"rgba(18, 18, 18, 0.03)",borderRadius:"2px"},"label:DivCardH;"),ii=(0,Be.Z)("div",{target:"efs4npu2"})({width:"147px",height:"202px",marginBottom:"16px",background:"rgba(18, 18, 18, 0.03)",borderRadius:"2px",marginRight:"14px"},"label:DivCard;"),oi=(0,s.memo)((function(){return(0,o.jsxs)(ei,{children:[(0,o.jsx)(ii,{},void 0),(0,o.jsx)(ii,{},void 0),(0,o.jsx)(ii,{},void 0),(0,o.jsx)(ii,{},void 0),(0,o.jsx)(ii,{},void 0),(0,o.jsx)(ii,{},void 0)]},void 0)})),ni=(0,s.memo)((function(){return(0,o.jsxs)(ei,{children:[(0,o.jsx)(ti,{},void 0),(0,o.jsx)(ti,{},void 0),(0,o.jsx)(ti,{},void 0),(0,o.jsx)(ti,{},void 0),(0,o.jsx)(ti,{},void 0),(0,o.jsx)(ti,{},void 0)]},void 0)}));var ri=i(66036),ai=i(69971),si=i(99915),li=i(39189),di=i(56749),ci=i(50259),ui=i(75570),vi=i(97870),pi=i(60067),hi=i(26274),mi=i(41641),gi=i(63261),xi=i(8815),bi=i(39353),fi=i(67002),wi=i(11809),ji=i(41143),_i=i(17425),yi=i(32509),Ci=i(46733),ki=i(68003),Si=i(90616),Ii=i(64281),Ti=i(55094),Mi=i(94673),Bi=(i(2836),i(37469),i(75246));(0,Bi.F4)({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}}),(0,Bi.F4)({"0%":{opacity:0,transform:"translate3d(.5em, calc(1 * .2em), 0) rotate(calc(1 * 20deg)) scale(.6)"},"20%":{opacity:.6,transform:"translate3d(.3em, calc(1 * 0), 0) rotate(calc(1 * 40deg)) scale(.8)"},"40%":{opacity:1,transform:"translate3d(.1em, calc(1 * -.2em), 0) rotate(calc(1 * 60deg)) scale(1)"},"60%":{transform:"translate3d(-.1em, calc(1 * -.4em), 0) rotate(calc(1 * 80deg))"},"80%":{opacity:.8,transform:"translate3d(-.2em, 1 * -.6em, 0) rotate(1 * 100deg)"},"100%":{opacity:0,transform:"translate3d(-.3em, calc(1 * -.8em), 0) rotate(calc(1 * 120deg))"}}),(0,Bi.F4)({"0%":{opacity:0,transform:"translate3d(.5em,calc(2 * .2em), 0) rotate(calc(2 * 20deg)) scale(.6)"},"20%":{opacity:.6,transform:"translate3d(.3em, calc(2 * 0), 0) rotate(calc(2 * 40deg)) scale(.8)"},"40%":{opacity:1,transform:"translate3d(.1em, calc(2 * -.2em), 0) rotate(calc(2 * 60deg)) scale(1)"},"60%":{transform:"translate3d(-.1em, calc(2 * -.4em), 0) rotate(calc(2 * 80deg))"},"80%":{opacity:.8,transform:"translate3d(-.2em, calc(2 * -.6em), 0) rotate(calc(2 * 100deg))"},"100%":{opacity:0,transform:"translate3d(-.3em, calc(2 * -.8em), 0) rotate(calc(2 * 120deg))"}}),(0,Bi.F4)({"0%":{opacity:0,transform:"translate3d(.5em, calc(3 * .2em), 0) rotate(calc(3 * 20deg)) scale(.6)"},"20%":{opacity:.6,transform:"translate3d(.3em, calc(3 * 0), 0) rotate(calc(3 * 40deg)) scale(.8)"},"40%":{opacity:1,transform:"translate3d(.1em, calc(3 * -.2em), 0) rotate(calc(3 * 60deg)) scale(1)"},"60%":{transform:"translate3d(-.1em, calc(3 * -.4em), 0) rotate(calc(3 * 80deg))"},"80%":{opacity:.8,transform:"translate3d(-.2em, calc(3 * -.6em), 0) rotate(calc(3 * 100deg))"},"100%":{opacity:0,transform:"translate3d(-.3em, calc(3 * -.8em), 0) rotate(calc(3 * 120deg))"}});const Li=(0,Be.Z)("div",{target:"e1fsiugq0"})((({theme:e})=>(0,Le.YJ)({direction:e.direction,end:"20px"})),(({needExtraBottom:e=!1})=>({display:"flex",flexDirection:"column",alignItems:"center",position:"absolute",top:e?"315px":"375px"})),"label:DivActionItemContainer;"),Di=((0,Bi.F4)({"0%":{transform:"scale(1)"},"50%":{transform:"scale(0.67)"},"100%":{transform:"scale(1)"}}),(0,Be.Z)("div",{target:"e1fsiugq5"})((({theme:e})=>[(0,Le.GI)({theme:e,fontWeight:"semiBold",typography:"P2"}),{width:"280px",padding:"8px 0px",maxHeight:"490px",overflowY:"auto","::-webkit-scrollbar-thumb":{background:e.colors.SDTertiary}}]),"label:DivShareWrapper;"));Di.defaultProps=Object.assign(Object.assign({},Di.defaultProps),{"data-e2e":"feed-share-group"});const Oi=(0,Be.Z)("svg",{target:"e1fsiugq12"})((({theme:{direction:e}})=>(0,Le.YJ)({direction:e,marginEnd:"5px"})),{verticalAlign:"middle"},"label:SvgIconFlag;"),Ei=(0,Be.Z)("div",{target:"e1fsiugq13"})((({theme:e})=>[(0,Le.GI)({theme:e,fontWeight:"semiBold",typography:"P2",color:"TextPrimary"}),{width:"280px",height:"58px",display:"flex",alignItems:"center",padding:"16px",boxSizing:"border-box",cursor:"pointer"}]),"label:DivEleWrapper;"),Pi=(0,Be.Z)($t,{target:"e1fsiugq14"})((({theme:{direction:e}})=>[(0,Le.YJ)({direction:e,marginEnd:"4px"})]),"label:StyledTranscriptIcon;"),Zi="#fff",Ri="#161823",zi={flexDirection:"row",position:"relative",top:0,right:0,width:"100%",height:"40px",paddingBottom:"24px",boxSizing:"content-box",borderBottom:"1px solid #F1F1F1"},Fi=(0,s.memo)((function(e){const{itemId:t,style:i,onClickLike:n,onClickShare:r,onClickComment:l,isHorizontal:d=!1,needExtraBottom:c=!1}=e,u=(0,T.fz)(Zt),v=(0,x.Q)(),{isRTL:h}=(0,Ft.Y)(),[m,g]=(0,s.useState)(0),f=h?"rightBottom":"leftBottom",w=(0,s.useMemo)((()=>({offset:[h?20:-20,10*Math.min(m,10)]})),[h,m]),j=(0,s.useMemo)((()=>({maxWidth:"unset",filter:"drop-shadow(0px 2px 12px rgba(0, 0, 0, 0.12))"})),[]),_=(0,s.useMemo)((()=>({padding:"0 4px"})),[]),y=h?"right":"left",C=(0,s.useMemo)((()=>({offset:[h?20:-20]})),[h]),[k={},S]=(0,a.b7)(E.A,{selector:e=>e[t],dependencies:[t]}),[{subtitleContent:I},M]=(0,a.b7)(ye),{author:B="",id:L="",digged:O=!1}=(0,b.m7)(k),Z=(0,a.mp)(Ve.z,{selector:e=>{if(B)return e.users[B]},dependencies:[k]}),{secUid:R="",uniqueId:z="",id:F=""}=(0,b.m7)(Z),V=(0,Ue.X)({action:(0,s.useCallback)((()=>{null==n||n(),S.postLikeVideo({id:t,enter_method:"click",play_mode:"video_detail"})}),[S,t,n]),modalConfig:{query:{enter_method:"click_like"}}}),$=(0,T.fz)(ji.p),q=(0,T.fz)(D),[W,N]=(0,s.useState)(!1),[A,U]=(0,s.useState)(!1),[G,Y]=(0,s.useState)(!1),[J,Q]=(0,s.useState)(!1),K=(0,s.useRef)(0),X=(0,s.useRef)(0),ee=(0,s.useRef)(0),te=(0,s.useRef)(0),{expanded:ie}=(0,Ti.c)(),oe=(0,s.useCallback)((()=>{var e,i;G||(N(!W),$.handleClickShare({author_id:null!==(e=null==Z?void 0:Z.id)&&void 0!==e?e:"",to_user_id:null!==(i=null==Z?void 0:Z.id)&&void 0!==i?i:"",group_id:t,play_mode:"video_detail"})),null==r||r()}),[G,r,W,$,null==Z?void 0:Z.id,t]),ne=(0,s.useCallback)((()=>{var e;$.handleSharePanelShow({group_id:t,to_user_id:null!==(e=null==Z?void 0:Z.id)&&void 0!==e?e:"",play_mode:"video_detail",share_option_type:ie}),window.clearTimeout(K.current),window.setTimeout((()=>{N(!0)}),100)}),[ie,t,$,null==Z?void 0:Z.id]),re=(0,s.useCallback)((()=>{G||(window.clearTimeout(ee.current),K.current=window.setTimeout((()=>{N(!1)}),300))}),[G]),ae=(0,s.useCallback)((()=>{q.handleKebabMenuHoverReport({group_id:t}),window.clearTimeout(X.current),te.current=window.setTimeout((()=>{U(!0)}),100)}),[t,q]),se=(0,s.useCallback)((()=>{window.clearTimeout(te.current),X.current=window.setTimeout((()=>{U(!1)}),300)}),[]),le=(0,s.useCallback)((e=>{Y(e)}),[]),de=(0,s.useCallback)((()=>{Q(!0)}),[Q]),ce=(0,Mi.V)(t),ue=(0,Ti.J)();(0,s.useEffect)((()=>{ue()}),[ue]);const ve=(0,Si.Q)({item:k,play_mode:"video_detail",onShow:mt.NS}),pe=(0,s.useMemo)((()=>(0,o.jsxs)(Ei,Object.assign({onMouseEnter:ae,onMouseLeave:se,onClick:ve},{children:[(0,o.jsx)(Oi,Object.assign({viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",width:16,height:15},{children:(0,o.jsx)("use",{xlinkHref:"#svg-flag"},void 0)}),void 0),v("Report")]}),void 0)),[ae,se,ve,v]),he=(0,s.useCallback)((()=>{M.setIfShowSubtitle(!0),u.handleShowTranscriptPanel("click_transcript",0)}),[M,u]),{isInActionBar:me}=(0,p.II)(),ge=(0,s.useMemo)((()=>(0,o.jsxs)(Ei,Object.assign({onMouseEnter:ae,onMouseLeave:se,onClick:he},{children:[(0,o.jsx)(Pi,{},void 0),v("asr_transcript_onpc_kebab_menu_ab_transcript_button")]}),void 0)),[ae,se,he,v]),xe=(0,s.useCallback)((()=>(0,o.jsxs)(o.Fragment,{children:[me&&(null==I?void 0:I.length)>0?ge:null,pe]},void 0)),[I,me,ge,pe]),be=(0,s.useMemo)((()=>({group_id:t,to_user_id:F,author_id:F,play_mode:"video_detail"})),[t,F]),fe=(0,T.fz)(P._),we=(0,s.useMemo)((()=>d?24:32),[d]),je=(0,s.useMemo)((()=>(0,o.jsx)(gi.Z,{width:we,height:we,fill:d?Ri:Zi},void 0)),[d,we]),_e=(0,s.useMemo)((()=>(0,o.jsx)(xi.Z,{width:we,height:we,fill:d?Ri:Zi},void 0)),[d,we]),Ce=(0,s.useMemo)((()=>(0,o.jsx)(bi.Z,{width:we,height:we,fill:d?Ri:Zi},void 0)),[d,we]),ke=(0,s.useMemo)((()=>(0,o.jsx)(fi.Z,{width:we,height:we,fill:d?Ri:Zi},void 0)),[d,we]),Se=(0,s.useMemo)((()=>(0,o.jsx)(wi.Z,{width:we,height:we,fill:d?Ri:Zi},void 0)),[d,we]),Ie=(0,s.useMemo)((()=>(0,o.jsx)(ki.Z,{isLiked:O,likedIcon:je,unlikeIcon:Se},void 0)),[O,Se,je]),{stats:Te,id:Me}=(0,b.m7)(k),Be=`https://www.tiktok.com${(0,H.fH)({uniqueId:z,secUid:R,videoId:Me})}`,Le=(0,s.useMemo)((()=>(0,o.jsx)(Di,Object.assign({onMouseEnter:ne,onMouseLeave:re},{children:(0,o.jsx)(Ii.mB,{mode:1,videoId:L,url:Be,embedCode:ce,enabled:k.shareEnabled,teaParams:be,onPlatformCountChange:g,onOtherModalOpen:le,onSendMessagePanelOpen:de},void 0)}),void 0)),[ce,le,de,ne,re,k.shareEnabled,be,Be,L]),De=(0,s.useCallback)((()=>{Q(!1)}),[Q]),Oe=(0,Ue.X)({action:(0,s.useCallback)((()=>{fe.handleClickCommentButton(Object.assign(Object.assign({},be),{action:"open"})),null==l||l()}),[fe,l,be]),modalConfig:{query:{enter_method:"click_comment"}}}),Ee=(0,s.useMemo)((()=>{const e={position:"absolute",top:"4px",transform:"rotate(-90deg)",opacity:"0.9"};return h?e.left=0:e.right=0,e}),[h]);if(!k)return(0,We.G)(["item"]);const Pe=d?Object.assign(Object.assign({},i),zi):i;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(Li,Object.assign({needExtraBottom:c,style:Pe},{children:[(0,o.jsx)(Ci.i,{text:(0,b.BT)(null==Te?void 0:Te.diggCount),Icon:Ie,onClick:V,e2eTag:"like",normalText:!0,isHorizontal:d},void 0),(0,o.jsx)(Ci.i,{text:(0,b.BT)(null==Te?void 0:Te.commentCount),Icon:_e,onClick:Oe,e2eTag:"comment",normalText:!0,isHorizontal:d},void 0),(0,o.jsx)(yi.u,Object.assign({destroyTooltipOnHide:!0,visible:W,placement:f,overlay:Le,align:w,overlayStyle:j,overlayInnerStyle:_,tooltipTheme:"white",zIndex:999},{children:(0,o.jsx)(Ci.i,{text:(null==Te?void 0:Te.shareCount)?(0,b.BT)(null==Te?void 0:Te.shareCount):v("Share"),Icon:ke,onMouseEnter:ne,onMouseLeave:re,onClick:oe,e2eTag:"share",normalText:!0,isHorizontal:d},void 0)}),void 0),(0,o.jsx)(yi.u,Object.assign({visible:A,placement:y,align:C,overlay:xe(),overlayStyle:j,overlayInnerStyle:_,tooltipTheme:"white",zIndex:999},{children:(0,o.jsx)(Ci.i,{onMouseEnter:ae,onMouseLeave:se,Icon:Ce,e2eTag:"more-entrance",style:d?Ee:void 0},void 0)}),void 0)]}),void 0),J&&(0,o.jsx)(_i.J,{visible:J,videoId:Me,onClose:De},void 0)]},void 0)}));var Vi,$i,qi=i(28049),Hi=i(50542),Wi=i(87905),Ni=i(10207),Ai=i(36773),Ui=i(18515),Gi=i(62013),Yi=i(28360);function Ji(){return Ji=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},Ji.apply(this,arguments)}const Qi=function(e){return s.createElement("svg",Ji({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",width:"1em",height:"1em"},e),Vi||(Vi=s.createElement("g",{fill:"white",fillRule:"evenodd",clipPath:"url(#expand_svg__clip0_9489_175555)",clipRule:"evenodd"},s.createElement("path",{d:"M10.88 3.88a.5.5 0 01.5-.5h8.37a1 1 0 011 1v8.37a.5.5 0 01-.5.5h-1a.5.5 0 01-.5-.5V5.38h-7.37a.5.5 0 01-.5-.5v-1zM13.37 20a.5.5 0 01-.5.5H4.5a1 1 0 01-1-1v-8.37a.5.5 0 01.5-.5h1a.5.5 0 01.5.5v7.37h7.37a.5.5 0 01.5.5v1z"}))),$i||($i=s.createElement("defs",null,s.createElement("clipPath",{id:"expand_svg__clip0_9489_175555"},s.createElement("path",{fill:"white",d:"M0 0h24v24H0z"})))))},Ki=(0,Be.Z)("div",{target:"ea1obu40"})({width:"100%",position:"absolute",bottom:"0"},"label:DivSeekBarContainer;"),Xi=(0,Be.Z)("div",{target:"ea1obu41"})({maxWidth:"64px",marginInlineStart:"8px",fontSize:"14px",lineHeight:"20px",color:"#ffffff",textAlign:"end",whiteSpace:"nowrap",fontFeatureSettings:'"tnum"',fontVariantNumeric:"tabular-nums",fontFamily:"Tahoma, PingFangSC, sans-serif"},"label:DivSeekBarTimeContainer;"),eo=(0,Be.Z)("div",{target:"ea1obu42"})({height:"4px",width:"100%",backgroundColor:"rgba(255, 255, 255, 0.2)",position:"absolute",left:"0",bottom:"0",cursor:"pointer"},"label:DivSeekBarProgress;"),to=(0,Be.Z)("div",{target:"ea1obu43"})((({theme:{colors:e,direction:t}})=>({height:"4px",width:"100%",backgroundColor:e.Primary,position:"absolute",bottom:"0",cursor:"pointer",borderBottomLeftRadius:"rtl"===t?"0":"4px",borderBottomRightRadius:"rtl"===t?"4px":"0",transformOrigin:"rtl"===t?"right":"left"})),"label:DivSeekBar;"),io=(0,Be.Z)("div",{target:"ea1obu44"})((({theme:{direction:e}})=>(0,Le.YJ)({direction:e})),(({theme:{direction:e}})=>({display:"none",width:"18px",height:"18px",position:"absolute",zIndex:10,bottom:0,transform:`translate(${"rtl"===e?"50%":"-50%"}, 6px)`,cursor:"pointer"})),"label:DivSeekBarCircleWrapper;"),oo=(0,Be.Z)("div",{target:"ea1obu45"})((({theme:{direction:e,colors:t}})=>[(0,Le.YJ)({direction:e,start:"3px"}),{width:"12px",height:"12px",backgroundColor:"#ffffff",borderRadius:"12px",position:"absolute",zIndex:10,bottom:"3px",boxShadow:`0px 0px 3px ${t.TextPrimary}`}]),"label:DivSeekBarCircle;"),no=(0,Be.Z)("div",{target:"ea1obu46"})((({needExtraBottom:e=!1})=>({width:"100%",position:"absolute",userSelect:"none",height:e?"calc(100% - 60px)":"100%",opacity:1,bottom:e?"60px":"0",cursor:"initial",display:"flex",flexDirection:"column",[`:hover ${io}`]:{display:"block"},[`:hover ${to}, :hover ${eo}`]:{height:"6px"}})),"label:DivVideoControlContainer;"),ro=(0,Be.Z)("div",{target:"ea1obu47"})((({active:e})=>[{position:"absolute",width:"100%",display:"flex",alignItems:"center",paddingInlineStart:"16px",bottom:"22px",opacity:e?"1":"0",transition:"all .3s ease"}]),"label:DivControlButtonWrapper;"),ao=(0,Be.Z)("div",{target:"ea1obu48"})((({theme:{direction:e},active:t,showActionBar:i})=>[{position:"absolute",cursor:"pointer",bottom:"20px",display:"flex",flexDirection:"column",alignItems:"center",opacity:t?"1":"0",transition:"opacity .5s"},(0,Le.YJ)({direction:e,start:"unset",end:i?"72px":"16px"})]),"label:DivVoiceControlContainer;"),so=(0,Be.Z)("div",{target:"ea1obu49"})({opacity:1,width:"40px",height:"24px",display:"flex",justifyContent:"center",transition:"opacity .3s"},"label:DivMuteIconContainer;"),lo=(0,Be.Z)("div",{target:"ea1obu410"})({width:"24px",height:"24px",display:"flex",justifyContent:"center",cursor:"pointer"},"label:DivPlayIconContainer;"),co=(0,Be.Z)(Qi,{target:"ea1obu411"})((({theme:{direction:e},active:t,showActionBar:i})=>[{position:"absolute",cursor:"pointer",bottom:"20px",width:"24px",height:"24px",alignItems:"center",opacity:t?"1":"0",transition:"opacity .5s"},(0,Le.YJ)({direction:e,start:"unset",end:i?"116px":"60px"})]),"label:StyledExpand;"),uo={width:24,height:24,fill:"#fff"},vo=(0,s.memo)((function(e){const t=(0,s.useRef)(null),i=(0,s.useRef)(null),n=(0,s.useRef)(null),r=(0,s.useRef)(null),[l,d]=(0,s.useState)(!1),[c,u]=(0,s.useState)(!1),[v,p]=(0,s.useState)(!1),[h,m]=(0,s.useState)(!1),{direction:g}=(0,Ni.u)(),x=(0,s.useRef)(0),b=(0,s.useRef)(null),{videoId:f,pause:w=!1,seek:j,videoRef:_,progressReportCallback:y,progressPreviewReportCallback:C,onGoBrowserMode:k,onDoubleClick:S,onTogglePlay:I,noneActionBar:M,hasBrowserMode:B,needExtraBottom:L}=e,E=(0,T.fz)(D),{duration:P,videoPercent:Z,currentTime:R}=(0,a.mp)(qt.M,{selector:e=>e[f]?e[f]:{duration:0,videoPercent:0,currentTime:0},dependencies:[f]}),{percent:z,bindDrag:F,seek:V}=(0,Ui.S)({direction:g,progressRef:i,circleRef:n,barRef:r,initialPercent:0,draggingStateCb:d,draggingPercentCb:j,progressReportCallback:y}),{mute:$,setMute:q}=(0,O.s_)(4),[H,W]=(0,s.useState)(!1),N=(0,s.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),q(!$)}),[$,q]),A=(0,s.useMemo)((()=>w?(0,o.jsx)("svg",Object.assign({viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg"},uo,{children:(0,o.jsx)("use",{xlinkHref:"#svg-play-fill"},void 0)}),void 0):(0,o.jsx)(qi.Z,Object.assign({},uo),void 0)),[w]),G=(0,s.useMemo)((()=>$?(0,o.jsx)(Hi.Z,Object.assign({},uo),void 0):(0,o.jsx)(Wi.Z,Object.assign({},uo),void 0)),[$]),Y=(0,s.useCallback)((()=>{clearTimeout(x.current),p(!0)}),[]),J=(0,s.useCallback)((()=>{x.current=window.setTimeout((()=>{p(!1)}),500)}),[]),Q=(0,s.useCallback)((()=>{m(!0)}),[]),K=(0,s.useCallback)((()=>{m(!1)}),[]);(0,s.useEffect)((()=>{C()}),[C]),(0,s.useEffect)((()=>{var e,t;null===(e=_.current)||void 0===e||e.onSeeked((()=>{setTimeout((()=>{u(!1)}),0)})),null===(t=_.current)||void 0===t||t.onSeeking((()=>{u(!0)}))}),[_.current,u]);const X=(0,s.useCallback)((e=>{(0,mt.UW)(e),E.handleEnterBrowserModeReport({group_id:f}),k()}),[k,E,f]),ee=(0,Gi.D)((()=>({onClick:I,onDoubleClick:S})),[I,S]),te=l||c?z:Z,ie="ltr"===g?{left:`calc(${100*te}%)`}:{right:`calc(${100*te}%)`},oe=v||l,ne=v||l||$||H;return(0,o.jsxs)(no,Object.assign({needExtraBottom:L,onClick:ee,ref:b,onMouseEnter:Y,onMouseLeave:J,onMouseDown:mt.UW},{children:[(0,o.jsx)(Ai.ZP,Object.assign({in:oe,timeout:500,nodeRef:b},{children:(0,o.jsxs)(ro,Object.assign({active:oe},{children:[(0,o.jsx)(lo,Object.assign({onClick:e.onTogglePlay},{children:A}),void 0),(0,o.jsx)(Xi,{children:"ltr"===g?`${(0,U.x)(R)}/${(0,U.x)(P)}`:`${(0,U.x)(P)}/${(0,U.x)(R)}`},void 0)]}),void 0)}),void 0),B?(0,o.jsx)(Ai.ZP,Object.assign({in:oe,timeout:500,nodeRef:b},{children:(0,o.jsx)(co,{active:oe,showActionBar:!M,onClick:X},void 0)}),void 0):null,(0,o.jsx)(Ai.ZP,Object.assign({in:ne,timeout:500,nodeRef:b},{children:(0,o.jsxs)(ao,Object.assign({showActionBar:!M,active:ne,onMouseEnter:Q,onMouseLeave:K,onMouseDown:mt.UW},{children:[H||h&&!l?(0,o.jsx)(Yi.y,{isStyleV2:!0,setVolumeDragging:W},void 0):null,(0,o.jsx)(so,Object.assign({mute:$,onClick:N},{children:G}),void 0)]}),void 0)}),void 0),(0,o.jsxs)(Ki,Object.assign({ref:t},{children:[(0,o.jsx)(eo,{ref:i,onClick:V,onMouseDown:F},void 0),(0,o.jsx)(io,Object.assign({ref:n,style:ie,onMouseDown:F},{children:(0,o.jsx)(oo,{},void 0)}),void 0),(0,o.jsx)(to,{ref:r,style:{width:100*te+"%"},onClick:V,onMouseDown:F},void 0)]}),void 0)]}),void 0)})),po=(0,Be.Z)("div",{target:"e1x3ivt90"})({position:"absolute",width:"100%",height:"100%",left:0,top:0,overflow:"hidden",borderRadius:"4px"},"label:DivBlurBackgroundWrapper;"),ho=(0,Be.Z)("div",{target:"e1x3ivt91"})({position:"absolute",width:"10%",height:"10%",filter:"blur(2px)",transform:"scale(11)",opacity:"0.3",background:"center no-repeat",backgroundSize:"cover",left:"50%",top:"50%"},"label:DivBlurBackground;"),mo=(0,Be.Z)("div",{target:"e1x3ivt92"})((({hasBottomLine:e=!0})=>({borderBottom:e?"1px solid #F1F1F1":"none"})),"label:DivVideoInfoContainer;"),go=(0,Be.Z)("div",{target:"e1x3ivt93"})({width:"100%",position:"relative"},"label:DivPlayerContainer;"),xo=(0,Be.Z)("svg",{target:"e1x3ivt94"})({position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",pointerEvents:"none"},"label:SvgPlayIcon;"),bo=(0,Be.Z)("div",{target:"e1x3ivt95"})({position:"relative",width:"100%",height:"100%",cursor:"pointer"},"label:DivVideoWrapper;"),fo=(0,Be.Z)("div",{target:"e1x3ivt96"})((({theme:{colors:e}})=>({width:"100%",height:"606px",background:e.ConstBGInverse,position:"relative",borderRadius:"4px",marginBottom:"24px"})),"label:DivVideoContainer;"),wo=(0,Be.Z)("div",{target:"e1x3ivt97"})((({theme:e})=>({width:"100%",height:"100%",left:"0",top:"0",backdropFilter:"blur(50px)",backgroundColor:e.colors.SDSecondary,position:"absolute",zIndex:2})),"label:DivMask;"),jo=(0,Be.Z)("div",{target:"e1x3ivt98"})({position:"absolute",top:"50%",transform:"translate(0, -50%)",width:"100%"},"label:DivMaskContainer;"),_o=(0,Be.Z)("div",{target:"e1x3ivt99"})((({theme:e})=>({width:"106px",height:"106px",padding:"33px",margin:"0 auto 0",borderRadius:"50%",backgroundColor:e.colors.LineSecondary,color:e.colors.Positive})),"label:DivMaskIcon;"),yo=(0,Be.Z)("div",{target:"e1x3ivt910"})((({theme:e})=>({maxWidth:"419px",margin:"24px auto 0",fontSize:"24px",lineHeight:"32px",textAlign:"center",color:e.colors.BGPrimary})),"label:DivMaskTitle;"),Co=(0,Be.Z)("div",{target:"e1x3ivt911"})((({theme:e})=>({maxWidth:"419px",margin:"16px auto 0",fontSize:"18px",lineHeight:"24px",textAlign:"center",color:e.colors.BGPrimary})),"label:DivMaskDetail;"),ko=(0,Be.Z)("button",{target:"e1x3ivt912"})((({theme:e})=>({maxWidth:"419px",height:"56px",cursor:"pointer",margin:"224px auto 0",borderRadius:"2px",backgroundColor:e.colors.ConstBGContainer,color:e.colors.BGPrimary,padding:"16px",fontSize:"18px",lineHeight:"24px",textAlign:"center",border:"none",display:"block"})),"label:ButtonMask;"),So=(0,s.forwardRef)(((e,t)=>{var i,n,r;const{item:l,currentIndex:d,teaParams:c,onScrollToComment:u}=e,v=(0,x.Q)(),h=(0,a.qj)(E.A),[m,g]=(0,s.useState)(!1),b=(0,s.useRef)(null),f=(0,s.useRef)(!1),{isUseNativePlayer:w,xgplayerVid:j}=(0,p.It)(),{hasBrowserMode:_,actionBarInPlayer:y}=(0,p.xy)(),C=null!==(i=null==l?void 0:l.id)&&void 0!==i?i:"",k=(0,s.useCallback)(((e="click")=>{h.postLikeVideo(Object.assign({id:C,enter_method:e},c))}),[h,C,c]),S=(0,Ue.X)({action:k,modalConfig:{query:{enter_method:"click_like"}}}),{videoPlayerRef:I,togglePlay:M,handleLinkClick:B}=function({pause:e,setPause:t,handleLikeClick:i}){const o=(0,s.useRef)(null),{enhanceVideoConsumptionVersion:n="v1"}=(0,ht.m)(),{mute:r,setMute:l}=(0,O.s_)(2),[,d]=(0,s.useState)(!1),c=(0,a.mp)(W.r,{selector:e=>e.isOpen,dependencies:[]}),u=(0,s.useCallback)((()=>{var i,n,r,a;e?null===(n=null===(i=o.current)||void 0===i?void 0:i.play)||void 0===n||n.call(i):null===(a=null===(r=o.current)||void 0===r?void 0:r.pause)||void 0===a||a.call(r),t(!e)}),[e,t]),v=(0,s.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),l(!r,"keydown")}),[r,l]),p=(0,s.useCallback)((e=>{if(27!==e.keyCode&&["input","textarea"].includes(e.target.tagName.toLocaleLowerCase())||"true"===e.target.getAttribute("contenteditable")||c)return;const t=new Map([[76,()=>{"v3"===n&&i("keydown")}],[77,()=>{"v3"===n&&v(e)}]]),o=e.keyCode;t.has(o)&&(e.preventDefault(),t.get(o)())}),[n,i,v,c]),h=(0,s.useRef)(""),[,m]=(0,s.useState)(0),[{isInputEmpty:g,noReplyUser:x}]=(0,a.b7)(bt.p,{selector:({isInputEmpty:e,reply:t})=>({isInputEmpty:e,noReplyUser:0===t.nickname.length}),dependencies:[]}),b=(0,s.useCallback)(((e,t)=>{g&&x||((0,mt.PF)(e),m(2),d(!0),h.current=t)}),[g,x]);return(0,s.useEffect)((()=>(document.addEventListener("keydown",p),()=>{document.removeEventListener("keydown",p)})),[p]),{handleLinkClick:b,preventDefault:mt.PF,togglePlay:u,videoPlayerRef:o}}({pause:m,setPause:e=>{g(e),f.current=e},handleLikeClick:S}),L=(0,a.qj)(qt.M),D=(0,s.useCallback)((e=>{var t,i,o;const n=null===(t=I.current)||void 0===t?void 0:t.duration;L.setVideoInfo({videoId:C,videoPercent:e,duration:n,currentTime:null!==(o=null===(i=I.current)||void 0===i?void 0:i.currentTime)&&void 0!==o?o:0})}),[C,L,I]),P=(0,s.useCallback)((e=>{var t,i;null===(i=null===(t=I.current)||void 0===t?void 0:t.seek)||void 0===i||i.call(t,e)}),[I]),Z=(0,s.useCallback)((e=>{var t,i;null===(i=null===(t=I.current)||void 0===t?void 0:t.seekTime)||void 0===i||i.call(t,e)}),[I]);(0,s.useImperativeHandle)(t,(()=>({seekTime:Z})));const{progressReportCallback:R,progressPreviewReportCallback:F}=(0,mi.CE)({pause:m,videoPlayerRef:I,videoReportParams:c});(0,s.useEffect)((()=>{var e,t;g(!1),D(0),null===(t=null===(e=I.current)||void 0===e?void 0:e.play)||void 0===t||t.call(e)}),[d,D,I]);const V=(0,Ue.X)({action:(0,s.useCallback)((e=>{const{clientX:t,clientY:i}=e;new ai.B(t,i).emit(),h.postLikeVideo({id:C,forceLike:!0})}),[C,h])}),$=(0,s.useCallback)((()=>{g(!0),f.current=!0}),[]),q=(0,T.fz)(si.B),{showBrowserMode:H,isBrowserModeShowing:N}=(0,s.useContext)(z._),A=(0,s.useCallback)((()=>{var e,t;H({index:d,playProgress:null!==(t=null===(e=I.current)||void 0===e?void 0:e.currentTime)&&void 0!==t?t:0,belowPlayMode:4,teaParams:c}),q.handleEnterBrowser(c)}),[H,d,q,c]);(0,s.useEffect)((()=>{N||g(!1)}),[N]);const U=(0,a.mp)(li.bg,{selector:e=>e.blockedVideos||[],dependencies:[]}),G=(0,a.mp)(ye,{selector:e=>{var t;return null!==(t=e.subtitleStruct)&&void 0!==t?t:null},dependencies:[d]}),Y=(0,a.qj)(li.bg),J=(0,s.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),l&&Y.removeBlockVideo(l.id)}),[Y,l]),Q=(0,s.useCallback)((()=>{u()}),[u]);if(!l||!(null==l?void 0:l.video))return(0,We.G)(["item.video"]);const{video:{cover:K,playAddr:X="",width:ee=1,height:te=1},id:ie,itemMute:oe,warnInfo:ne,scheduleTime:re}=l,ae=(ee/te||1)>=1,se=Boolean(null==ne?void 0:ne[0])||Boolean(re);return(0,o.jsxs)(go,{children:[(0,o.jsxs)(fo,Object.assign({ref:b},{children:[(0,o.jsx)(po,{children:(0,o.jsx)(ho,{style:{backgroundImage:`url(${K})`}},void 0)},void 0),(0,o.jsxs)(bo,{children:[(0,o.jsx)(di.S,{isInExperiment:!w,poster:K,horizontal:ae,mode:4,ref:I,desc:l.desc,id:ie,playUrl:X,index:d,itemMute:Boolean(oe),teaParams:c,playerTestVid:j,onVideoError:$,onTimeUpdate:D,subtitleStruct:G},ie),U.includes(l.id||"")?(0,o.jsx)(wo,{children:(0,o.jsxs)(jo,{children:[(0,o.jsx)(_o,{children:(0,o.jsx)(ri.Z,{width:40,height:40},void 0)},void 0),(0,o.jsx)(yo,{children:v("Web_report_thanks_for_report")},void 0),(0,o.jsx)(Co,{children:v("Web_report_hide_video")},void 0),(0,o.jsx)(ko,Object.assign({onClick:J},{children:v("Web_report_show_video")}),void 0)]},void 0)},void 0):null]},void 0),(0,o.jsx)(vo,{needExtraBottom:se,onGoBrowserMode:A,currentCanPlay:null!==(r=null===(n=I.current)||void 0===n?void 0:n.currentCanPlay)&&void 0!==r&&r,seek:P,videoId:C,pause:m,onDoubleClick:V,onTogglePlay:M,videoRef:I,progressReportCallback:R,progressPreviewReportCallback:F,noneActionBar:!y,hasBrowserMode:_},void 0),m&&(0,o.jsx)(xo,Object.assign({viewBox:"0 0 48 48",xmlns:"http://www.w3.org/2000/svg",width:70,height:70,fill:"#fff"},{children:(0,o.jsx)("use",{xlinkHref:"#svg-play-fill"},void 0)}),void 0),(null==ne?void 0:ne[0])&&(0,o.jsx)(hi.zo,{children:(0,o.jsx)(ci.p,{info:null==ne?void 0:ne[0]},void 0)},void 0),Boolean(re)&&(0,o.jsx)(hi.zo,{children:(0,o.jsx)(ui.W,{isTextAlignStart:!0,scheduledTime:Number(re),height:56,fontSize:14,iconSize:18.33,iconMargin:4.83},void 0)},void 0)]}),void 0),(0,o.jsxs)(mo,Object.assign({hasBottomLine:y},{children:[(0,o.jsx)(vi.Q,{onLinkClick:B,item:l,e2eTag:"browse-video-desc",reportParams:c},void 0),(0,o.jsx)(pi._,{onLinkClick:B,styleType:1,item:l,e2eTag:"browse-music",teaParams:c},void 0)]}),void 0),(0,o.jsx)(Fi,{needExtraBottom:y&&se,onClickComment:Q,isHorizontal:!y,itemId:C,isPaused:m},void 0)]},void 0)}));var Io=i(80829),To=i(63908);const Mo=(0,Be.Z)("div",{target:"e1awmzaq0"})((({isNarrowState:e=!1})=>({display:"flex",flexDirection:"column",marginTop:e?"23px":"0",borderBottom:e?"1px solid #F1F1F1":"none"})),"label:DivListContainer;"),Bo=(0,Be.Z)("div",{target:"e1awmzaq1"})({width:"100%",height:"90px",marginBottom:"24px",cursor:"pointer",display:"flex"},"label:DivItemContainer;"),Lo=(0,Be.Z)("div",{target:"e1awmzaq2"})((({theme:e})=>(0,Le.YJ)({direction:e.direction,marginEnd:"12px"})),{height:"100%",width:"120px",position:"relative",borderRadius:"2px",overflow:"hidden",flex:"0 0 120px"},"label:DivCoverContainer;"),Do=(0,Be.Z)("img",{target:"e1awmzaq3"})({width:"100%",height:"100%",objectFit:"cover",background:"#F8F8F8"},"label:ImgCover;"),Oo=(0,Be.Z)("div",{target:"e1awmzaq4"})({position:"absolute",bottom:"4px",right:"4px",background:"rgba(0, 0, 0, 0.7)",borderRadius:"2px",padding:"2px",fontSize:"12px",color:"#fff"},"label:DivDuration;"),Eo=(0,Be.Z)("div",{target:"e1awmzaq5"})({flex:"1"},"label:DivInfoContent;"),Po=(0,Be.Z)("div",{target:"e1awmzaq6"})((({theme:e})=>(0,Le.GI)({theme:e,fontWeight:"bold"})),(0,Le.FC)(2),{fontSize:"14px",lineHeight:"20px",color:"#161823",marginBottom:"8px",wordBreak:"break-word"},"label:DivTitle;"),Zo=(0,Be.Z)("div",{target:"e1awmzaq7"})(Le.wj,{color:"rgba(22, 24, 35, 0.75)",fontSize:"12px",lineHeight:"16px",marginBottom:"4px",display:"flex",alignItems:"center"},"label:DivAuthor;"),Ro=(0,Be.Z)("div",{target:"e1awmzaq8"})({display:"flex",height:"16px",color:"rgba(22, 24, 35, 0.75)",alignItems:"center",fontSize:"12px"},"label:DivOtherInfo;"),zo=(0,Be.Z)("div",{target:"e1awmzaq9"})((({theme:e})=>[(0,Le.YJ)({direction:e.direction,marginEnd:"8px"})]),"label:DivDate;"),Fo=(0,Be.Z)(To.Z,{target:"e1awmzaq10"})((({theme:e})=>[(0,Le.YJ)({direction:e.direction,marginEnd:"4px"})]),"label:StyledHeart;"),Vo=(0,Be.Z)(Xe.W,{target:"e1awmzaq11"})({marginBottom:"24px",minWidth:"unset",fontSize:"16px",paddingLeft:"16px",paddingRight:"16px"},"label:StyledMoreBtn;"),$o=(0,Be.Z)("div",{target:"e1awmzaq12"})({width:"100%",display:"flex",justifyContent:"center"},"label:DivLoadingWrapper;"),qo=(0,s.memo)((e=>{const{item:t,index:i,isNarrowState:n}=e,{video:{cover:r,duration:l},desc:d,author:c="",createTime:u,stats:v}=t,p=(0,a.mp)(Ve.z,{selector:e=>e.users[c],dependencies:[c]}),{timeTranslator:h}=(0,$e.e)(),{uniqueId:m,verified:g}=null!=p?p:{},x=(0,T.fz)(D);(0,s.useEffect)((()=>{x.handleVideoCoverShowReport({author_id:c,group_id:t.id,rank:i})}),[]);const f=(0,a.qj)(ye),w=(0,s.useCallback)((()=>{x.handleVideoCoverClickReport({author_id:c,group_id:t.id,rank:i}),f.handleSelectVideo({newIndex:i})}),[c,i,t.id,x,f]);return(0,o.jsxs)(Bo,Object.assign({isNarrowState:n},{children:[(0,o.jsxs)(Lo,Object.assign({onClick:w},{children:[(0,o.jsx)(Do,{src:r},void 0),(0,o.jsx)(Oo,{children:(0,U.x)(l)},void 0)]}),void 0),(0,o.jsxs)(Eo,{children:[(0,o.jsx)(Po,{children:d},void 0),(0,o.jsxs)(Zo,{children:[m,g&&(0,o.jsx)(Ge.Q,{width:10,height:10},void 0),(0,o.jsx)("span",Object.assign({style:{margin:"0 4px"}},{children:" · "}),void 0),(0,o.jsx)(zo,{children:h(1e3*Number(u))},void 0)]},void 0),(0,o.jsxs)(Ro,{children:[(0,o.jsx)(Fo,{width:16,height:16,fill:"rgba(22, 24, 35, 0.75)"},void 0),(0,b.BT)(null==v?void 0:v.diggCount)]},void 0)]},void 0)]}),void 0)})),Ho=(0,s.memo)((({itemList:e,isNarrowState:t,onLoadMore:i,hasMore:n,isLoading:r})=>{const a=e.slice(1),l=(0,x.Q)(),{narrowStateHasMore:d,handleLoadMore:c,narrowStateList:u}=ft({relatedList:a,isNarrowState:t,onLoadMore:i,hasMore:n,isLoading:r}),v=t?d?(0,o.jsx)("div",{children:(0,o.jsx)(Vo,Object.assign({size:"medium",disabled:r,buttonTheme:"line",onClick:c},{children:l("video_details_page_morevideos_btn")}),void 0)},void 0):null:r&&a.length>1&&n?(0,o.jsx)($o,{children:(0,o.jsx)(Io.g,{},void 0)},void 0):null,p=(0,s.useMemo)((()=>t?u:a),[t,u,a]);return(0,o.jsxs)(Mo,Object.assign({isNarrowState:t},{children:[p.map(((e,t)=>e&&(0,o.jsx)(qo,{index:t+1,item:e},e.id))),v]}),void 0)})),Wo=(0,Be.Z)("div",{target:"eeth2s70"})((({isNarrowState:e=!1})=>({display:"flex",justifyContent:e?"":"space-between",flexWrap:"wrap"})),"label:DivListContainer;"),No=(0,Be.Z)("div",{target:"eeth2s71"})((({theme:e,isNarrowState:t})=>(0,Le.YJ)({marginEnd:t?"14px":"0px",direction:e.direction})),{width:"147px",marginBottom:"16px",cursor:"pointer"},"label:DivItemContainer;"),Ao=(0,Be.Z)("div",{target:"eeth2s72"})({width:"100%",height:"202px",position:"relative",borderRadius:"2px",marginBottom:"8px",overflow:"hidden"},"label:DivCoverContainer;"),Uo=(0,Be.Z)("img",{target:"eeth2s73"})({width:"100%",height:"100%",objectFit:"cover",background:"#F8F8F8"},"label:ImgCover;"),Go=(0,Be.Z)("div",{target:"eeth2s74"})({position:"absolute",bottom:"4px",right:"4px",background:"rgba(0, 0, 0, 0.7)",borderRadius:"2px",padding:"2px",fontSize:"12px",color:"#fff"},"label:DivDuration;"),Yo=(0,Be.Z)("div",{target:"eeth2s75"})((({theme:e})=>(0,Le.GI)({theme:e,fontWeight:"bold"})),(0,Le.FC)(3),{color:"#161823",marginBottom:"4px",wordBreak:"break-word"},"label:DivTitle;"),Jo=(0,Be.Z)("div",{target:"eeth2s76"})({color:"rgba(22, 24, 35, 0.75)",fontSize:"12px",lineHeight:"16px",marginBottom:"4px",display:"flex",alignItems:"center"},"label:DivAuthor;"),Qo=(0,Be.Z)("div",{target:"eeth2s77"})({display:"flex",height:"16px",color:"rgba(22, 24, 35, 0.75)",alignItems:"center",fontSize:"12px"},"label:DivOtherInfo;"),Ko=(0,Be.Z)("div",{target:"eeth2s78"})((({theme:e})=>[(0,Le.YJ)({direction:e.direction,marginEnd:"8px"})]),"label:DivDate;"),Xo=(0,Be.Z)(To.Z,{target:"eeth2s79"})((({theme:e})=>[(0,Le.YJ)({direction:e.direction,marginEnd:"4px"})]),"label:StyledHeart;"),en=(0,Be.Z)("div",{target:"eeth2s710"})({borderBottom:"1px solid #F1F1F1",marginTop:"23px"},"label:DivListWrapper;"),tn=(0,Be.Z)(Xe.W,{target:"eeth2s711"})({marginBottom:"24px",minWidth:"unset",fontSize:"16px",paddingLeft:"16px",paddingRight:"16px"},"label:StyledMoreBtn;"),on=(0,Be.Z)("div",{target:"eeth2s712"})({width:"100%",display:"flex",justifyContent:"center"},"label:DivLoadingWrapper;"),nn=(0,s.memo)((e=>{const{item:t,index:i,isNarrowState:n}=e,{video:{cover:r,duration:l},desc:d,author:c="",createTime:u,stats:v}=t,p=(0,T.fz)(D);(0,s.useEffect)((()=>{p.handleVideoCoverShowReport({author_id:c,group_id:t.id,rank:i})}),[]);const h=(0,a.mp)(Ve.z,{selector:e=>e.users[c],dependencies:[c]}),{timeTranslator:m}=(0,$e.e)(),{uniqueId:g,verified:x}=null!=h?h:{},f=(0,a.qj)(ye),w=(0,s.useCallback)((()=>{p.handleVideoCoverClickReport({author_id:c,group_id:t.id,rank:i}),f.handleSelectVideo({newIndex:i})}),[p,c,t.id,i,f]);return(0,o.jsxs)(No,Object.assign({isNarrowState:n},{children:[(0,o.jsxs)(Ao,Object.assign({onClick:w},{children:[(0,o.jsx)(Uo,{src:r},void 0),(0,o.jsx)(Go,{children:(0,U.x)(l)},void 0)]}),void 0),(0,o.jsx)(Yo,{children:d},void 0),(0,o.jsxs)(Jo,{children:[g,x&&(0,o.jsx)(Ge.Q,{width:10,height:10},void 0)]},void 0),(0,o.jsxs)(Qo,{children:[(0,o.jsx)(Ko,{children:m(1e3*Number(u))},void 0),(0,o.jsx)(Xo,{width:16,height:16,fill:"rgba(22, 24, 35, 0.75)"},void 0),(0,b.BT)(null==v?void 0:v.diggCount)]},void 0)]}),void 0)})),rn=(0,s.memo)((({itemList:e,isNarrowState:t,onLoadMore:i,hasMore:n,isLoading:r})=>{const a=e.slice(1),s=(0,x.Q)(),{narrowStateHasMore:l,handleLoadMore:d,narrowStateList:c}=ft({relatedList:a,isNarrowState:t,onLoadMore:i,hasMore:n,isLoading:r});return t?(0,o.jsxs)(en,{children:[(0,o.jsx)(Wo,Object.assign({isNarrowState:t},{children:c.map(((e,i)=>e&&(0,o.jsx)(nn,{isNarrowState:t,index:i+1,item:e},e.id)))}),void 0),l?(0,o.jsx)(tn,Object.assign({size:"medium",disabled:r,buttonTheme:"line",onClick:d},{children:s("video_details_page_morevideos_btn")}),void 0):null]},void 0):(0,o.jsxs)(Wo,{children:[a.map(((e,t)=>e&&(0,o.jsx)(nn,{index:t+1,item:e},e.id))),r&&a.length>1&&n?(0,o.jsx)(on,{children:(0,o.jsx)(Io.g,{},void 0)},void 0):null]},void 0)})),an=(0,o.jsx)(n.Z,Object.assign({},C.vj),void 0),sn=(0,o.jsx)(r.Z,Object.assign({},C.vj),void 0),ln=(0,g.l)((function({itemId:e}){var t;const i=(0,x.Q)(),n=(0,T.fz)(D),[r,d]=(0,s.useState)(!1),[{currentIndex:c,itemListKey:v,subtitleContent:h,ifShowSubtitle:m},g]=(0,a.b7)(ye),b=(0,a.qj)(Ze.x),f=(0,s.useRef)(!1),_=(0,s.useRef)(null);(0,s.useEffect)((()=>{var e;c&&(null===(e=_.current)||void 0===e||e.scrollIntoView())}),[c]);const y=(0,s.useRef)(null),k=(0,s.useCallback)((e=>{var t;null===(t=null==y?void 0:y.current)||void 0===t||t.seekTime(e)}),[y]);(0,s.useEffect)((()=>{b.fetchComment({aweme_id:e})}),[e,b]),(0,O.$v)(4),(0,s.useEffect)((()=>{d(window.innerWidth<903)}),[]);const{browserList:S,listHasMore:I,listLoading:M}=(0,a.mp)(u.h,{selector:e=>{const t=e[null!=v?v:""];return t?{browserList:t.browserList,listHasMore:t.hasMore,listLoading:t.loading}:{browserList:[],listHasMore:!1,listLoading:!1}},dependencies:[]});(0,s.useEffect)((()=>{!f.current&&S.length>=1&&(g.handleFirstVideo(),f.current=!0)}),[S]);const[{itemList:B,currentItem:L,subtitleInfos:F}]=(0,a.b7)(E.A,{selector:e=>{var t,i;return{itemList:S.map((t=>e[t])),currentItem:e[S[c]],subtitleInfos:null===(i=null===(t=e[S[c]])||void 0===t?void 0:t.video)||void 0===i?void 0:i.subtitleInfos}},dependencies:[S,c]}),V=null!==(t=null==L?void 0:L.id)&&void 0!==t?t:"",$=(0,s.useMemo)((()=>({author:"",scheduleTime:""})),[]),{author:q="",scheduleTime:H}=null!=L?L:$,W=function({id:e}){const t=(0,a.qj)(Ze.x),i=(0,s.useRef)(null),o=(0,s.useCallback)((()=>{t.fetchComment({aweme_id:e})}),[t,e]);return(0,s.useEffect)((()=>()=>{t.dispose$(),t.setCommentItem({awemeId:""})}),[t]),(0,gt.q)({elemRef:i,onHitBottom:o,bottomThreshold:20,throttle:500}),i}({id:V}),{currentIndex:N}=(0,a.mp)(Pe.O),{isBrowserModeShowing:A}=(0,s.useContext)(z._);(0,s.useEffect)((()=>{A&&g.handleSelectVideo({newIndex:N})}),[N,A,g]);const{isDefaultHidden:U,isDownloadTranscript:G,isDefaultExpanded:Y}=(0,p.II)(),[J,Q]=(0,s.useState)(Y);(0,s.useEffect)((()=>{G&&F&&(null==F?void 0:F.length)>0&&g.downloadTranscript({subtitleInfos:F})}),[F,g,G]);const K=Ie(),X=(0,Z.s)({onHitBottom:K}),ee=(0,a.mp)(Se,{selector:({statusCode:e})=>e,dependencies:[]}),te=(0,s.useMemo)((()=>{const{video:{bitrate:e=-1,encodedType:t="",format:i="",videoQuality:o="",encodeUserTag:n="",codecType:r="",definition:a=""}={},authorId:s="",id:l="",scheduleTime:d,secret:c=!1,forFriend:u=!1}=null!=L?L:{video:{}};return{author_id:s,group_id:l,is_scheduled:Boolean(d),bitrate:Number(e),encodedType:t,format:i,videoQuality:o,encodeUserTag:n,codecType:r,definition:a,secret:c,forFriend:u}}),[L]),ie=(0,l.k6)(),oe=(0,T.fz)(P._),ne=(0,s.useCallback)((()=>{const{id:e=""}=null!=L?L:{};n.handleBackFypReport({group_id:e}),oe.handleEnterPage("enter_homepage_hot",{enter_method:"back_fyp_click",group_id:e}),ie.push(`${R.Ad.foryou}?enter_from=video_detail`)}),[ie,L,n,oe]),{isServerError:re,isCommonError:ae,isInitLoading:se,isEmpty:le}=Te(),de=Me();if(re)return(0,o.jsx)(Oe,{children:(0,o.jsx)(w.T,{iconElem:C.hE,title:i("server_error_title"),desc:i("server_error_sub"),buttonText:i("refresh"),onButtonClick:de},void 0)},void 0);if(ae){const{title:e,desc:t}=(0,j.S9)(ee),n=10239===ee?sn:an;return(0,o.jsx)(Oe,{children:(0,o.jsx)(w.T,{iconElem:n,title:i((0,j.V5)(ee)),desc:i((0,j.ox)(ee)),e2eTitle:e,e2eDesc:t},void 0)},void 0)}if(le)return null;!function({onPageWidthBreakPoint:e}){const t=(0,xt.fB)((()=>{null==e||e(window.innerWidth<903)}),[e],500);(0,s.useEffect)((()=>(window.addEventListener("resize",t),()=>window.removeEventListener("resize",t))),[t])}({onPageWidthBreakPoint:(0,s.useCallback)((e=>{e!==r&&d(e)}),[r])});const{verticalVideoPanel:ce,hasFYPBack:ue}=(0,p.xy)(),ve=(0,s.useCallback)((()=>{const e={onLoadMore:K,isLoading:M,hasMore:I,isNarrowState:r,itemList:B},t=(null==B?void 0:B.length)<=1&&I||se;return ce?t?(0,o.jsx)(oi,{},void 0):(0,o.jsx)(rn,Object.assign({},e),void 0):t?(0,o.jsx)(ni,{},void 0):(0,o.jsx)(Ho,Object.assign({},e),void 0)}),[B,I,se,r,M,K,ce]),pe=(0,s.useCallback)((()=>{var e;null===(e=null==W?void 0:W.current)||void 0===e||e.scrollIntoView()}),[W]);return(0,o.jsxs)(jt,{children:[(0,o.jsx)(_t,{ref:_},void 0),ue?(0,o.jsx)(yt,{children:(0,o.jsxs)(Ct,Object.assign({onClick:ne},{children:[(0,o.jsx)(kt,{width:32,height:32},void 0),(0,o.jsx)(St,{children:i("display_comments_videodetailspage_back_arrow_foryoufeed")},void 0)]}),void 0)},void 0):null,(0,o.jsxs)(It,{children:[(0,o.jsxs)(Tt,{children:[se?(0,o.jsx)(Dt,{},void 0):(0,o.jsx)(So,{onScrollToComment:pe,teaParams:te,item:L,currentIndex:c,ref:y},void 0),q?(0,o.jsx)(Mt,{children:(0,o.jsx)(at,{teaParams:te,uniqueId:q,videoId:V},void 0)},void 0):null,r&&(m||!U)&&(null==h?void 0:h.length)>0?(0,o.jsx)(Xt,{item:L,onSeek:k,isNarrow:!0,isListShow:J,setIsListShow:Q},void 0):null,r?ve():null,(0,o.jsx)(pt,{scheduleTime:Number(H),ref:W,teaParams:te,itemId:V,disableReply:!1},void 0)]},void 0),r?null:(0,o.jsxs)(Bt,Object.assign({ref:X},{children:[(m||!U)&&(null==h?void 0:h.length)>0?(0,o.jsx)(Xt,{item:L,onSeek:k,isNarrow:!1,isListShow:J,setIsListShow:Q},void 0):null,(0,o.jsx)(Lt,{children:i("display_comments_videodetailspage_recommendedvideos_panel_header")},void 0),ve()]}),void 0)]},void 0)]},void 0)})),dn=(0,_.r)("video",!1)((function(){const[{statusCode:e},t]=(0,a.b7)(Se),{enterForyou:i}=(0,a.mp)(d.e);(0,y.a)(i?"homepage_hot":"video_detail"),(0,c.M3)();const[{list:n,preloadList:r},g]=(0,a.b7)(u.h,{selector:e=>{var t,i,o,n,r,a;return{list:null!==(i=null===(t=e.video)||void 0===t?void 0:t.list)&&void 0!==i?i:[],statusCode:null!==(n=null===(o=e.video)||void 0===o?void 0:o.statusCode)&&void 0!==n?n:0,preloadList:null!==(a=null===(r=e.video)||void 0===r?void 0:r.preloadList)&&void 0!==a?a:[]}},dependencies:[]}),{id:x}=(0,l.UO)();!function(){var e;const t=(0,l.k6)(),{$user:i,$region:o=""}=null!==(e=(0,f.L)((()=>["$user","$region"]),[]))&&void 0!==e?e:{},{id:n}=(0,l.UO)();(0,G.L)((()=>{const{search:e,pathname:r,hash:a}=window.location,s=(0,$.parse)(e),l=Object.assign({},s);s.cid&&"string"==typeof s.cid&&(delete l.cid,window.history.replaceState(window.history.state,window.document.title,`${r}?${(0,$.stringify)(l)}${a}`));const d=Y.S.includes(o),c=J.$I.getItem("cid"),u=null!=c?c:s.cid;if(!d||!u||"string"!=typeof u)return;if(!Boolean(i))return J.$I.setItem("cid",u),void J.$I.setItem("vid",n);const v=J.$I.getItem("vid");if(J.$I.removeAll(),void 0!==v&&v!==n)return;const p=(0,Q._)(u);p&&(l.browserMode="1",t.push(`${r}?${(0,$.stringify)(l)}${a}`,{cid:p,vid:n,browserMode:!0}))}),[t,i,o,n])}(),function({list:e}){const{id:t}=(0,l.UO)(),i=(0,l.TH)(),o=i.state,{showBrowserMode:n}=(0,s.useContext)(z._),r=(0,s.useRef)(!1),a=(0,s.useRef)(t),d=(0,l.k6)();(0,s.useEffect)((()=>{const{browserMode:s,vid:l}=(0,b.m7)(o);a.current!==t&&(r.current=!1),s&&t===l&&(null==e?void 0:e.length)&&e[0]===l&&!r.current&&(d.replace(Object.assign(Object.assign({},i),{state:Object.assign(Object.assign({},o),{browserMode:!1})})),r.current=!0,a.current=t,n({index:0}))}),[t,e,o,n,d,i])}({list:n}),(()=>{const{list:e}=(0,a.mp)(u.h,{selector:e=>{var t;return null!==(t=e.video)&&void 0!==t?t:{list:[],loading:!1,statusCode:0}},dependencies:[]}),{hasNewVideoDetailPage:t}=(0,p.xy)(),{search:i,pathname:o}=(0,l.TH)(),n=t&&(0,N.cQ)(o),r=(0,T.fz)(P._),{setEnterForyou:c}=(0,a.qj)(d.e),v=(0,a.mp)(A.f,{selector:e=>{var t,i;return Number(null!==(i=null===(t=e.currentVideo)||void 0===t?void 0:t.index)&&void 0!==i?i:0)},dependencies:[]}),h=e[v],m=(0,a.mp)(E.A,{selector:e=>e[null!=h?h:""],dependencies:[h]}),g=(0,q.p)(null==m?void 0:m.author),{uniqueId:x="",secUid:b=""}=null!=g?g:{},f=function(e,t,i,o,n){const r=(0,H.fH)({uniqueId:t,videoId:i,secUid:o});return n?(0,$.stringifyUrl)({url:r,query:Object.assign(Object.assign({},V()((0,$.parse)(e),"sender_device","sender_web_id","item_id")),{is_from_webapp:"v1",item_id:i})},{skipNull:!0}):`${(0,$.stringifyUrl)({url:"/foryou",query:Object.assign(Object.assign({},V()((0,$.parse)(e),"sender_device","sender_web_id","item_id")),{is_from_webapp:"v1",item_id:i})},{skipNull:!0})}#${r}`}(i,x,h,b,n);(0,s.useEffect)((()=>{location.pathname!==R.Ad.foryou&&v>0&&e.length>0&&r.handleEnterPage("enter_homepage_hot",{enter_method:"see_more"}),(location.pathname===R.Ad.foryou||v>0)&&e.length>0&&(c(!n),window.history.replaceState(window.history.state,"video-detail",f))}),[r,v,e,f,c,n])})(),(()=>{const{id:e}=(0,l.UO)(),{pathname:t,search:i}=(0,l.TH)(),o=(0,s.useMemo)((()=>{var e;return null===(e=/^\/@(.+)\/video\/\d+/.exec(t))||void 0===e?void 0:e[1]}),[t]),n=(0,s.useMemo)((()=>{var e;return null===(e=/^\/@.+\/video\/(\d+)/.exec(t))||void 0===e?void 0:e[1]}),[t]),r=(0,a.mp)(E.A,{selector:e=>e[null!=n?n:""],dependencies:[n]}),d=(0,q.p)(null==r?void 0:r.author),{uniqueId:c,secUid:u}=null!=d?d:{},v=(0,H.nY)({uniqueId:c,secUid:u});(0,s.useEffect)((()=>{if(v&&n===e&&o!==v){const e=`/@${v}/video/${n}${i}`,t=Object.assign(Object.assign({},history.state),{as:e});window.history.replaceState(t,"open_video_page",e)}}),[e,v,o,i,n])})(),(0,v.s)(r),(0,s.useEffect)((()=>{t.getVideoDetail({itemId:x})}),[t,x]),(0,s.useEffect)((()=>{0===e&&1===n.length&&g.getRecommendList({key:"video"})}),[g,n.length,e]),(0,s.useEffect)((()=>()=>{g.resetItemList({key:"video",loading:!0})}),[x,g]);const w=(0,s.useMemo)((()=>({isMsePlayer:!0})),[]),{hasNewVideoDetailPage:j}=(0,p.xy)();return(0,o.jsx)(h.V.Provider,Object.assign({value:w},{children:(0,o.jsxs)(De,Object.assign({showVideoCommentDetail:j},{children:[j?(0,o.jsx)(ln,{itemId:x},void 0):(0,o.jsx)(vn,{},void 0),(0,o.jsx)(m.vr,{},"static-fixed")]}),void 0)}),void 0)})),cn=(0,o.jsx)(n.Z,Object.assign({},C.vj),void 0),un=(0,o.jsx)(r.Z,Object.assign({},C.vj),void 0),vn=(0,g.l)((function(){const e=(0,x.Q)(),t=Ie(),i=function(){const[e]=(0,a.b7)(u.h,{selector:e=>{var t;return null!==(t=e.video)&&void 0!==t?t:{list:[],loading:!1,hasMore:!0,statusCode:0}},dependencies:[]}),t=(0,a.qj)(W.r),{statusCode:i,hasMore:o}=e;return(0,s.useCallback)((()=>{o||10404!==i||t.openModal({isSignup:!1,query:{redirect_url:window.location.href,enter_method:"vv_limit"}})}),[t,i,o])}(),{isServerError:n,isCommonError:r,isInitLoading:l,isEmpty:d}=Te();(0,k.AS)("video",t);const c=Me(),v=(0,s.useCallback)((()=>(0,o.jsx)(Ee,Object.assign({"data-e2e":"recommend-video-text"},{children:e("video_detail_explore_title")}),void 0)),[e]),{list:p,loading:h}=(0,a.mp)(u.h,{selector:e=>{var t;return null!==(t=e.video)&&void 0!==t?t:{list:[],loading:!1,statusCode:0}},dependencies:[]}),m=(0,a.mp)(Se,{selector:({statusCode:e})=>e,dependencies:[]}),{$isGoogleBot:g}=(0,b.m7)((0,f.L)((()=>["$isGoogleBot"]),[]));if(l)return(0,o.jsx)(S.H,{},void 0);if(n)return(0,o.jsx)(Oe,{children:(0,o.jsx)(w.T,{iconElem:C.hE,title:e("server_error_title"),desc:e("server_error_sub"),buttonText:e("refresh"),onButtonClick:c},void 0)},void 0);if(r){const{title:t,desc:i}=(0,j.S9)(m),n=10239===m?un:cn;return(0,o.jsx)(Oe,{children:(0,o.jsx)(w.T,{iconElem:n,title:e((0,j.V5)(m)),desc:e((0,j.ox)(m)),e2eTitle:t,e2eDesc:i},void 0)},void 0)}return d?null:p.length?(0,o.jsx)(I.SL,{itemList:p,loading:h,renderInnerIndex:0,renderInner:v,onHitBottom:t,onPageBottom:i,ssrLimitDisable:g},void 0):null})),pn=dn}}]);