"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[4992],{46733:(e,t,n)=>{n.d(t,{i:()=>u});var o=n(74512),i=n(32735),a=n(40200),l=n(29984);const d=(0,a.Z)("button",{target:"efnabn0"})((({theme:{colors:e,direction:t},isHorizontal:n=!1})=>[l.Ph,(0,l.YJ)({direction:t,marginEnd:n?"16px":"0px"}),{position:"relative",display:"flex",alignItems:"center",cursor:"pointer",marginBottom:n?"0":"8px",flexDirection:n?"row":"column",":disabled":{cursor:"default",color:e.TextPrimary}}]),"label:ButtonActionItem;"),r=(0,a.Z)("span",{target:"efnabn1"})((({theme:e,isHorizontal:t=!1})=>[(0,l.YJ)({direction:e.direction,marginEnd:t?"9px":"0px"}),{display:"flex",justifyContent:"center",alignItems:"center",width:"32px",height:"32px",fontSize:"0px",borderRadius:"50%",transition:"all ease-in-out 200ms",opacity:t?"0.9":1}]),"label:SpanIconWrapper;"),s=(0,a.Z)("strong",{target:"efnabn2"})((({theme:e,isHorizontal:t=!1,normalText:n=!1})=>[(0,l.GI)({theme:e,typography:"P3",fontWeight:t||n?"normal":"bold"}),{textAlign:"center",color:t?"#161823":"#fff"}]),"label:StrongText;"),u=(0,i.memo)((function(e){const{text:t,Icon:n,disabled:i,children:a,e2eTag:l,style:u={},isHorizontal:c=!1,normalText:v=!1}=e;return(0,o.jsxs)(d,Object.assign({isHorizontal:c,type:"button",onClick:e.onClick,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,disabled:i,style:u},{children:[(0,o.jsx)(r,Object.assign({isHorizontal:c,"data-e2e":`${l}-icon`},{children:n}),void 0),t&&(0,o.jsx)(s,Object.assign({normalText:v,isHorizontal:c,"data-e2e":`${l}-count`},{children:t}),void 0),a]}),void 0)}))},68003:(e,t,n)=>{n.d(t,{Z:()=>d});var o=n(74512),i=n(87308),a=n(32735);const l=(0,i.ZP)({resolved:{},chunkName:()=>"animation",isReady(e){const t=this.resolve(e);return!0===this.resolved[t]&&!n.m[t]},importAsync:()=>Promise.all([n.e(2539),n.e(5530),n.e(1050)]).then(n.bind(n,23895)),requireAsync(e){const t=this.resolve(e);return this.resolved[t]=!1,this.importAsync(e).then((e=>(this.resolved[t]=!0,e)))},requireSync(e){const t=this.resolve(e);return n(t)},resolve:()=>23895}),d=({likedIcon:e,unlikeIcon:t,isLiked:n})=>{const[i,d]=(0,a.useState)(!1),r=(0,a.useRef)(!1);(0,a.useEffect)((()=>{n&&r.current&&d(n)}),[n]),(0,a.useEffect)((()=>{d(!n),r.current=!0}),[]);const s=(0,a.useCallback)((()=>{d(!1)}),[]);return n?(0,o.jsx)("div",{children:i?(0,o.jsx)(l,{autoplay:!0,onComplete:s},void 0):e},void 0):t}},41641:(e,t,n)=>{n.d(t,{HT:()=>k,q5:()=>L,Xc:()=>S,CE:()=>I,OG:()=>E,PE:()=>M});var o=n(24246),i=n(32321),a=n(32735),l=n(22538),d=n(86987),r=n(57852),s=n(99915),u=n(52970),c=n(73323),v=n(54032),p=n(86303),m=n(11166),h=n(42018),g=n(69971),_=n(62013),b=n(90883),y=n(66163),w=n(36668),C=n(52646);const f=e=>{var t,n;null===(t=null==e?void 0:e.preventDefault)||void 0===t||t.call(e),null===(n=null==e?void 0:e.stopPropagation)||void 0===n||n.call(e)},x=()=>{var e;const{$user:t}=null!==(e=(0,d.L)((()=>["$user"]),[]))&&void 0!==e?e:{};return{hasLogin:Boolean(t)}},k=({swiperRef:e,videoPlayerRef:t})=>{const{isInputEmpty:n,noReplyUser:i}=(0,o.mp)(w.p,{selector:({isInputEmpty:e,reply:t})=>({isInputEmpty:e,noReplyUser:0===t.nickname.length}),dependencies:[]}),[{loginCTAShowing:l,onboardingShowing:d,leavingModalShowing:r},s]=(0,o.b7)(C._,{selector:({onboardingShowing:e,loginCTAShowing:t,leavingModalShowing:n})=>({onboardingShowing:e,loginCTAShowing:t,leavingModalShowing:n}),dependencies:[]});(0,a.useEffect)((()=>{var t,o,a,u;l||d||r||!n||!i?(null===(o=null===(t=e.current)||void 0===t?void 0:t.disable)||void 0===o||o.call(t),s.setDisabled(!0)):(null===(u=null===(a=e.current)||void 0===a?void 0:a.enable)||void 0===u||u.call(a),s.setDisabled(!1))}),[n,s,r,l,i,d,e,t])};function L({pause:e,setPause:t,videoNumber:n,setVideoNumber:d,group_id:k,handleLikeClick:L,author_id:S,itemListKey:I,videoChangeMethodRef:E,swiperRef:M,teaParams:P}){const{updateVideoNumber:V}=(({setVideoNumber:e})=>{const{hasLogin:t}=x(),n=(0,a.useCallback)((()=>{if(t)r.To.setItem("swiper_login_cta",{videoNumber:0}),e(0);else{const t=r.To.getItem("swiper_login_cta"),{videoNumber:n=0}=null!=t?t:{};r.To.setItem("swiper_login_cta",{videoNumber:n+1}),e(n+1)}}),[t,e]);return(0,a.useEffect)((()=>{n()}),[n]),{updateVideoNumber:n}})({videoNumber:n,setVideoNumber:d}),[{currentIndex:T,disabled:O},j]=(0,o.b7)(C._),{hasLogin:N}=x(),[A,D]=(0,a.useState)(!1),[B,R]=(0,a.useState)(0),[{isInputEmpty:F,noReplyUser:z},{setNeedClearInput:K}]=(0,o.b7)(w.p,{selector:({isInputEmpty:e,reply:t})=>({isInputEmpty:e,noReplyUser:0===t.nickname.length}),dependencies:[]}),H=(0,i.fz)(s.B),{mute:$,setMute:U}=(0,u.s_)(3),q=(0,o.qj)(c.f),Y=(0,o.qj)(v.A),Z=(0,o.qj)(p.r),G=(0,a.useCallback)((e=>{f(e),U(!$,"keydown")}),[$,U]),Q=(0,a.useRef)(null),W=(0,a.useCallback)((()=>{var n,o,i,a,l,d;e?(q.updateVideo({currentVideo:{id:k,index:T,mode:3},playProgress:null!==(o=null===(n=Q.current)||void 0===n?void 0:n.currentTime)&&void 0!==o?o:0}),null===(a=null===(i=Q.current)||void 0===i?void 0:i.play)||void 0===a||a.call(i)):null===(d=null===(l=Q.current)||void 0===l?void 0:l.pause)||void 0===d||d.call(l),t(!e)}),[T,k,e,t,q]),J=(0,l.k6)(),X=(0,a.useRef)(""),ee=(0,a.useCallback)(((e,t)=>{!O||A||F&&z||(f(e),R(4),D(!0),j.setLeavingModalShowing(!0),X.current=t)}),[F,z,A,O,j]),te=(0,a.useCallback)((()=>{j.handleNextVideo(),V()}),[V,j]),ne=(0,a.useCallback)((()=>{const e={direction:"next",enter_method:E.current,play_mode:3,group_id:k,author_id:S,skipped_group_num:0,skipped_group_ids:""};H.handleVideoChange(e),"foryou"===I&&H.handleHotVideoChange(e)}),[E,k,S,H,I]),oe=(0,a.useCallback)((()=>{V(),j.handlePrevVideo()}),[V,j]),ie=(0,a.useCallback)((()=>{const e={direction:"prev",enter_method:E.current,play_mode:3,group_id:k,author_id:S,skipped_group_num:0,skipped_group_ids:""};H.handleVideoChange(e),"foryou"===I&&H.handleHotVideoChange(e)}),[E,k,S,H,I]),[{mute:ae},{setMute:le,setVolume:de}]=(0,o.b7)(m.x),re=(0,a.useCallback)((()=>{var e,t;A||(!O||F&&z?(null===(t=null===(e=null==M?void 0:M.current)||void 0===e?void 0:e.slideNext)||void 0===t||t.call(e),ae&&setTimeout((()=>{var e,t;le(null!==(e=r.Bv.getItem("muted"))&&void 0!==e?e:h.P[3].defaultMute),de(null!==(t=r.Bv.getItem("volume"))&&void 0!==t?t:h.G)}),400)):(D(!0),j.setLeavingModalShowing(!0),R(3)))}),[F,z,ae,le,de,A,O,j,M]),se=(0,a.useCallback)((()=>{var e,t;A||(!O||F&&z?null===(t=null===(e=null==M?void 0:M.current)||void 0===e?void 0:e.slidePrev)||void 0===t||t.call(e):(D(!0),j.setLeavingModalShowing(!0),R(2)))}),[F,z,A,O,j,M]),ue=(0,a.useCallback)((e=>{if(!N)return void Z.openModal({query:{enter_method:"click_comment"}});const{clientX:t,clientY:n}=e;new g.B(t,n).emit(),Y.postLikeVideo({id:k,forceLike:!0,play_mode:"large_video_mode"})}),[k,N,Y,Z]),ce=(0,_.D)((()=>({onClick:W,onDoubleClick:ue})),[W,ue]),ve=(0,a.useCallback)(((e,t)=>{const n=Number(t);[38,40].includes(n)&&setTimeout((()=>{j.setOnboardingShowing(!1)}),100);const o=new Map([[32,()=>{W()}],[76,()=>{L("keydown")}],[77,()=>{G()}]]);o.has(n)&&o.get(n)()}),[j,W,L,G]),pe=(0,a.useCallback)((e=>{if(O&&!A&&(!F||!z)){const t=e.deltaY>0?3:2;D(!0),j.setLeavingModalShowing(!0),R(t)}}),[F,z,A,O,j]),[me,he]=(0,a.useState)(!1),ge=(0,i.fz)(b._),_e=(0,a.useCallback)((()=>{if(O&&!A&&(!F||!z))return R(1),D(!0),void j.setLeavingModalShowing(!0);ge.handleCloseCommentPanel(Object.assign({},P)),he(!1)}),[ge,F,z,A,O,j,P]),be=(0,a.useCallback)((()=>{if(O&&!A&&(!F||!z))return R(1),D(!0),void j.setLeavingModalShowing(!0);ge.handleClickCommentButton(Object.assign(Object.assign({},P),{action:me?"close":"open"})),he(!me)}),[me,ge,F,z,A,O,j,P]),ye=(0,i.fz)(y.y),we=(0,a.useCallback)((()=>{switch(D(!1),K(!0),j.setLeavingModalShowing(!1),ye.handleLeaveComment({group_id:k}),B){case 2:t(!1),setTimeout((()=>{var e;null===(e=M.current)||void 0===e||e.slideTo(Math.max(0,T-1))}),50);break;case 3:t(!1),setTimeout((()=>{var e;null===(e=M.current)||void 0===e||e.slideTo(T+1)}),50);break;case 1:he(!1);break;case 4:X.current&&setTimeout((()=>{J.push(X.current)}),100)}}),[ye,B,T,k,J,K,t,j,M]),Ce=(0,a.useCallback)((()=>{R(0),D(!1),j.setLeavingModalShowing(!1),ye.handleKeepComment({group_id:k})}),[ye,k,j]);return{handleLinkClick:ee,handleWheel:pe,handleNextVideoStart:te,handlePrevVideoStart:oe,handleNextVideoEnd:ne,handlePrevVideoEnd:ie,handleClickSwitchToNext:re,handleClickSwitchToPrev:se,handleKeyDown:ve,handleVideoClick:ce,preventDefault:f,handleTogglePlay:W,videoPlayerRef:Q,showLeaveModal:A,isInputEmpty:F,handleConfirmLeave:we,handleCancelLeave:Ce,commentActive:me,handleCloseCommentPanel:_e,handleToggleCommentPanel:be}}const S=({videoChangeMethodRef:e,handleKeyDown:t})=>({handleSlideClick:(0,a.useCallback)(((t,n)=>{const o=n.path.some((e=>{var t,n;return null===(n=null===(t=null==e?void 0:e.className)||void 0===t?void 0:t.includes)||void 0===n?void 0:n.call(t,"ButtonSwitchButton")}));e.current=o?"click_button":"click_video_peek"}),[e]),handleSlideScroll:(0,a.useCallback)((()=>{e.current="scroll"}),[e]),handleSlideKeydown:(0,a.useCallback)(((n,o)=>{e.current="keydown",t(n,o)}),[t,e])}),I=({videoPlayerRef:e,pause:t,videoReportParams:n})=>{const o=(0,i.fz)(s.B);return{progressReportCallback:(0,a.useCallback)(((i,a)=>{var l,d;o.handleSeekBarClick(Object.assign({fromPercent:i,toPercent:a,video_length:null!==(d=null===(l=e.current)||void 0===l?void 0:l.duration)&&void 0!==d?d:0,is_pause:t,play_mode:"large_video_mode"},n))}),[t,o,n,e]),progressPreviewReportCallback:(0,a.useCallback)((()=>{var i,a;o.handleSeekBarAutoShow(Object.assign({video_length:null!==(a=null===(i=e.current)||void 0===i?void 0:i.duration)&&void 0!==a?a:0,is_pause:t,play_mode:"large_video_mode",show_method:"preview"},n))}),[t,o,e,n])}},E=({refScrollEl:e})=>{(0,a.useEffect)((()=>{const t=e=>{var t;null===(t=null==e?void 0:e.stopPropagation)||void 0===t||t.call(e)},n=e=>{var t;null===(t=null==e?void 0:e.stopPropagation)||void 0===t||t.call(e)},o=e.current;return o&&(null==o||o.addEventListener("mousewheel",t),null==o||o.addEventListener("DOMMouseScroll",t),null==o||o.addEventListener("mousedown",n),null==o||o.addEventListener("pointerdown",n),null==o||o.addEventListener("touchstart",n)),()=>{null==o||o.removeEventListener("mousewhell",t),null==o||o.removeEventListener("DOMMouseScroll",t),null==o||o.removeEventListener("mousedown",n),null==o||o.removeEventListener("pointerdown",n),null==o||o.removeEventListener("touchstart",n)}}),[e.current])},M=({setSwiperHeight:e})=>{const t=(0,a.useCallback)((()=>{const t=Math.max(360,document.documentElement.clientHeight-60-56);e(t)}),[e]);(0,a.useEffect)((()=>(window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)})))}},52646:(e,t,n)=>{n.d(t,{_:()=>_});var o=n(31191),i=n(6229),a=n(16219),l=n(11359),d=n(37674),r=n(2355),s=n(30526),u=n(31144),c=n(71011),v=n(52702),p=n(81104),m=n(62904),h=n(73323),g=n(79006);let _=class extends i.D{constructor(e,t,n){super(),this.itemList=e,this.videoPlayer=t,this.videoExperience=n,this.defaultState={currentIndex:0,disabled:!1,itemListKey:null,onboardingShowing:!1,loginCTAShowing:!1,leavingModalShowing:!1}}setItemListKey(e,t){e.itemListKey=t}setCurrentIndex(e,t){e.currentIndex=t}setDisabled(e,t){e.disabled=t}setOnboardingShowing(e,t){e.onboardingShowing=t}setLoginCTAShowing(e,t){e.loginCTAShowing=t}setLeavingModalShowing(e,t){e.leavingModalShowing=t}handleNextVideo(e){return e.pipe((0,s.b)((()=>{this.videoExperience.reportVideoInteractStart({startTime:Date.now(),situation:"swiper_slide_next"})})),(0,u.M)(this.state$,this.itemList.state$),(0,c.U)((([e,{itemListKey:t,currentIndex:n},o])=>{var i,a,l;const d=null!==(a=null===(i=o[null!=t?t:""])||void 0===i?void 0:i.browserList)&&void 0!==a?a:[],r=Math.min(n+1,d.length-1);return{newIndex:r,isIndexInvalid:!(null==d?void 0:d.length)||r<0,newId:null!==(l=d[r])&&void 0!==l?l:""}})),(0,s.b)((({isIndexInvalid:e})=>{e&&console.warn("cannot switch to next video for some reasons")})),(0,v.z)((e=>(0,d.of)(...this.updateVideoIndex(e)))),(0,p.n)({}))}handlePrevVideo(e){return e.pipe((0,s.b)((()=>{this.videoExperience.reportVideoInteractStart({startTime:Date.now(),situation:"swiper_slide_prev"})})),(0,u.M)(this.state$,this.itemList.state$),(0,c.U)((([e,{itemListKey:t,currentIndex:n},o])=>{var i,a,l;const d=null!==(a=null===(i=o[null!=t?t:""])||void 0===i?void 0:i.browserList)&&void 0!==a?a:[],r=Math.max(n-1,0);return{newIndex:r,isIndexInvalid:!(null==d?void 0:d.length)||r>d.length-1,newId:null!==(l=d[r])&&void 0!==l?l:""}})),(0,s.b)((({isIndexInvalid:e})=>{e&&console.warn("cannot switch to prev video for some reasons")})),(0,v.z)((e=>(0,d.of)(...this.updateVideoIndex(e)))),(0,p.n)({}))}handleFirstVideo(e){return e.pipe((0,u.M)(this.state$,this.itemList.state$),(0,c.U)((([e,{itemListKey:t},n])=>{var o,i,a;const l=null!==(i=null===(o=n[null!=t?t:""])||void 0===o?void 0:o.browserList)&&void 0!==i?i:[];return{newIndex:0,isIndexInvalid:!(null==l?void 0:l.length)||0>l.length-1,newId:null!==(a=l[0])&&void 0!==a?a:""}})),(0,s.b)((({isIndexInvalid:e})=>{e&&console.warn("cannot switch to first video for some reasons")})),(0,v.z)((e=>(0,d.of)(...this.updateVideoIndex(e)))),(0,p.n)({}))}updateVideoIndex({newIndex:e,isIndexInvalid:t,newId:n}){return t?[this.noop()]:[this.videoPlayer.getActions().updateVideo({currentVideo:{index:e,id:n,mode:3},playProgress:0}),this.getActions().setCurrentIndex(e)]}};(0,o.__decorate)([(0,a.lF)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Object]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"setItemListKey",null),(0,o.__decorate)([(0,a.lF)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Number]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"setCurrentIndex",null),(0,o.__decorate)([(0,a.lF)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Boolean]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"setDisabled",null),(0,o.__decorate)([(0,a.lF)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Boolean]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"setOnboardingShowing",null),(0,o.__decorate)([(0,a.lF)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Boolean]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"setLoginCTAShowing",null),(0,o.__decorate)([(0,a.lF)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[Object,Boolean]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"setLeavingModalShowing",null),(0,o.__decorate)([(0,a.Qm)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[r.y]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"handleNextVideo",null),(0,o.__decorate)([(0,a.Qm)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[r.y]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"handlePrevVideo",null),(0,o.__decorate)([(0,a.Qm)(),(0,o.__metadata)("design:type",Function),(0,o.__metadata)("design:paramtypes",[r.y]),(0,o.__metadata)("design:returntype",void 0)],_.prototype,"handleFirstVideo",null),_=(0,o.__decorate)([(0,l.Y)("SwiperModeModule"),(0,o.__metadata)("design:paramtypes",[m.h,h.f,g.KF])],_)}}]);